library(reshape)
library(ggplot2)
library(data.table)


# AJpacbio2 <- data.table()
# for(i in (list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20/",pattern="tsv"))) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     tmp1$key<-sub("^(.).*(_n_indel_.*)","\\1\\2",tmp1$key)
#     AJpacbio2 <- rbind(AJpacbio2,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted" | grepl("n_indel",tmp1$key),])
#   }
# }
# AJpacbiocast2 <- dcast(AJpacbio2, id ~ key + allele + sample,fill=0)
# hist(as.integer(as.character(AJpacbiocast2[AJpacbiocast2$weighted_count_alt_HG002_PB_70x>5,]$`0_n_indel_low_alt_HG002_PB_70x`))+as.integer(as.character(AJpacbiocast2[AJpacbiocast2$weighted_count_alt_HG002_PB_70x>5,]$`2_n_indel_low_alt_HG002_PB_70x`)),breaks=0:200)

#PacBio
AJpacbio <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    #tmp1$key<-sub("^(.).*(_n_indel_low)","\\1\\2",tmp1$key)
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset10kto20kMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset10kto20kMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset60kto73164MQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset60kto73164MQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset1to10kMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callsetMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset60kto73164MQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv0502techor4callset60kto73164MQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbio <- rbind(AJpacbio,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
AJpacbio$sample<-sub("_RG$","",AJpacbio$sample)

AJpacbiocast <- dcast(AJpacbio[!duplicated(AJpacbio[,.(id , key , allele , sample)]),], id ~ key + allele + sample,fill=0)
setkey(AJpacbiocast,"id")
contingencytable <- xtabs(~AJpacbiocast$GT_weighted__HG002_PB_70x+AJpacbiocast$GT_weighted__HG003_PB_30x+AJpacbiocast$GT_weighted__HG004_PB_30x, data=AJpacbiocast)
ftable(contingencytable,row.vars=c(1))

AJpacbiocast$GQ_HG002_PB_70x <- ifelse(AJpacbiocast$GT_weighted__HG002_PB_70x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG002_PB_70x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG002_PB_70x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG002_PB_70x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG002_PB_70x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbiocast$GQ_weighted__HG002_PB_70x,perl = TRUE),perl = TRUE))),0)))
AJpacbiocast$GQ_HG003_PB_30x <- ifelse(AJpacbiocast$GT_weighted__HG003_PB_30x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG003_PB_30x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG003_PB_30x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG003_PB_30x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG003_PB_30x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbiocast$GQ_weighted__HG003_PB_30x,perl = TRUE),perl = TRUE))),0)))
AJpacbiocast$GQ_HG004_PB_30x <- ifelse(AJpacbiocast$GT_weighted__HG004_PB_30x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG004_PB_30x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG004_PB_30x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbiocast$GQ_weighted__HG004_PB_30x,perl = TRUE),perl = TRUE))),ifelse(AJpacbiocast$GT_weighted__HG004_PB_30x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbiocast$GQ_weighted__HG004_PB_30x,perl = TRUE),perl = TRUE))),0)))

contingencytable <- xtabs(~AJpacbiocast$GT_weighted__HG002_PB_70x+(AJpacbiocast$GQ_HG002_PB_70x>=40 & AJpacbiocast$GQ_HG003_PB_30x>=30 & AJpacbiocast$GQ_HG004_PB_30x>=30)+AJpacbiocast$GT_weighted__HG003_PB_30x+AJpacbiocast$GT_weighted__HG004_PB_30x, data=AJpacbiocast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJpacbiocast, aes(x=GQ_HG002_PB_70x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x)
ggplot(AJpacbiocast, aes(x=GQ_HG003_PB_30x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_PB_30x)
ggplot(AJpacbiocast, aes(x=GQ_HG004_PB_30x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_PB_30x)
ggplot(AJpacbiocast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid( ~ GT_weighted__HG002_PB_70x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJpacbiocast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG003_PB_30x ~ GT_weighted__HG004_PB_30x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJpacbiocast, aes(x=as.integer(as.character(weighted_count_ref_HG003_PB_30x)), y=as.integer(as.character(weighted_count_alt_HG003_PB_30x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/500) +facet_grid( GT_weighted__HG002_PB_70x ~ GT_weighted__HG004_PB_30x)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJpacbiocast, aes(x=as.integer(as.character(weighted_count_ref_HG004_PB_30x)), y=as.integer(as.character(weighted_count_alt_HG004_PB_30x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/500) +facet_grid( GT_weighted__HG002_PB_70x ~ GT_weighted__HG003_PB_30x)+xlim(c(0,60))+ylim(c(0,60))



#pacbioHP by HP
AJpacbioHP <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset1to10kMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset1to10kMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    #tmp1$key<-sub("^(.).*(_n_indel_low)","\\1\\2",tmp1$key)
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset10kto20kMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset10kto20kMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset60kto73164MQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset60kto73164MQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset1to10kMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callset1to10kMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callsetMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHPv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP <- rbind(AJpacbioHP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

AJpacbioHPcast <- dcast(AJpacbioHP[!duplicated(AJpacbioHP[,.(id , key , allele , sample)]),], id ~ key + allele + sample,fill=0)
setkey(AJpacbioHPcast,"id")

AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS <- ifelse((AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "0/0" & AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "1/1") | (AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "1/1" & AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "1/1"),"1/1","./.")))
AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS <- ifelse((AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "0/0" & AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "1/1") | (AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "1/1" & AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "1/1"),"1/1","./.")))
AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS <- ifelse((AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "0/0" & AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "1/1") | (AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "0/0" & AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "1/1" & AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "1/1"),"1/1","./.")))

contingencytable <- xtabs(~AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS+AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS+AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS, data=AJpacbioHPcast)
ftable(contingencytable,row.vars=c(1))

AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS_HP1 <- ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS_HP2 <- ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG002_PB_70x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS <- pmin(AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS_HP1,AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS_HP2)*4
AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS_HP1 <- ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS_HP2 <- ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG003_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS <- pmin(AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS_HP1,AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS_HP2)*4
AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS_HP1 <- ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS_HP2 <- ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHPcast$GQ_weighted__HG004_PB_30x_RG_HP10XPASS_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS <- pmin(AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS_HP1,AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS_HP2)*4

sum(AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS=="./.")

contingencytable <- xtabs(~AJpacbioHPcast$GT_weighted__HG002_PB_70x_RG_HP10XPASS+(AJpacbioHPcast$GQ_HG002_PB_70x_RG_HP10XPASS>=40 & AJpacbioHPcast$GQ_HG003_PB_30x_RG_HP10XPASS>=40 & AJpacbioHPcast$GQ_HG004_PB_30x_RG_HP10XPASS>=40)+AJpacbioHPcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS+AJpacbioHPcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS, data=AJpacbioHPcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJpacbioHPcast, aes(x=GQ_HG002_PB_70x_RG_HP10XPASS)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)
ggplot(AJpacbioHPcast, aes(x=GQ_HG003_PB_30x_RG_HP10XPASS)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_PB_30x_RG_HP10XPASS)
ggplot(AJpacbioHPcast, aes(x=GQ_HG004_PB_30x_RG_HP10XPASS)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_PB_30x_RG_HP10XPASS)
ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XPASS ~ GT_weighted__HG004_PB_30x_RG_HP10XPASS)+xlim(c(0,60))+ylim(c(0,60))
#ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_PB_30x_RG_HP10XPASS)), y=as.integer(as.character(weighted_count_alt_HG003_PB_30x_RG_HP10XPASS)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10XPASS ~ GT_weighted__HG004_PB_30x_RG_HP10XPASS)+xlim(c(0,300))+ylim(c(0,300))
#ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_PB_30x_RG_HP10XPASS)), y=as.integer(as.character(weighted_count_alt_HG004_PB_30x_RG_HP10XPASS)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10XPASS ~ GT_weighted__HG003_PB_30x_RG_HP10XPASS)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)+xlim(c(0,1))+ylim(c(0,1))
ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XPASS ~ GT_weighted__HG004_PB_30x_RG_HP10XPASS)+xlim(c(0,1))+ylim(c(0,1))

ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)
ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)

ggplot(AJpacbioHPcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)


#pacbioHP10Xtrio332 by HP
AJpacbioHP10Xtrio332 <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHP10Xtriov332v0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHP10Xtriov332v0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    #tmp1$key<-sub("^(.).*(_n_indel_low)","\\1\\2",tmp1$key)
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset10kto20kMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset10kto20kMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset60kto73164MQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset60kto73164MQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset1to10kMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callset1to10kMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callsetMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10Xtriov332v050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJpacbioHP10Xtrio332 <- rbind(AJpacbioHP10Xtrio332,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

AJpacbioHP10Xtrio332cast <- dcast(AJpacbioHP10Xtrio332[!duplicated(AJpacbioHP10Xtrio332[,.(id , key , allele , sample)]),], id ~ key + allele + sample,fill=0)
setkey(AJpacbioHP10Xtrio332cast,"id")

AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332 <- ifelse((AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "1/1") | (AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "1/1" & AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "1/1"),"1/1","./.")))
AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332 <- ifelse((AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "1/1") | (AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "1/1" & AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "1/1"),"1/1","./.")))
AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332 <- ifelse((AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "1/1") | (AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "0/0" & AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "1/1" & AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "1/1"),"1/1","./.")))

contingencytable <- xtabs(~AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332+AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332+AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332, data=AJpacbioHP10Xtrio332cast)
ftable(contingencytable,row.vars=c(1))

AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332_HP1 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332_HP2 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG002_PB_70x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332 <- pmin(AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332_HP1,AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332_HP2)*4
AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332_HP1 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332_HP2 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG003_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332 <- pmin(AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332_HP1,AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332_HP2)*4
AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332_HP1 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332_HP2 <- ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10Xtrio332cast$GQ_weighted__HG004_PB_30x_RG_HP10Xv332_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332 <- pmin(AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332_HP1,AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332_HP2)*4

contingencytable <- xtabs(~AJpacbioHP10Xtrio332cast$GT_weighted__HG002_PB_70x_RG_HP10Xv332+(AJpacbioHP10Xtrio332cast$GQ_HG002_PB_70x_RG_HP10Xv332>=40 & AJpacbioHP10Xtrio332cast$GQ_HG003_PB_30x_RG_HP10Xv332>=40 & AJpacbioHP10Xtrio332cast$GQ_HG004_PB_30x_RG_HP10Xv332>=40)+AJpacbioHP10Xtrio332cast$GT_weighted__HG003_PB_30x_RG_HP10Xv332+AJpacbioHP10Xtrio332cast$GT_weighted__HG004_PB_30x_RG_HP10Xv332, data=AJpacbioHP10Xtrio332cast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJpacbioHP10Xtrio332cast, aes(x=GQ_HG002_PB_70x_RG_HP10Xv332)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)
ggplot(AJpacbioHP10Xtrio332cast, aes(x=GQ_HG003_PB_30x_RG_HP10Xv332)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_PB_30x_RG_HP10Xv332)
ggplot(AJpacbioHP10Xtrio332cast, aes(x=GQ_HG004_PB_30x_RG_HP10Xv332)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_PB_30x_RG_HP10Xv332)
ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10Xv332 ~ GT_weighted__HG004_PB_30x_RG_HP10Xv332)+xlim(c(0,60))+ylim(c(0,60))
#ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_ref_HG003_PB_30x_RG_HP10Xv332)), y=as.integer(as.character(weighted_count_alt_HG003_PB_30x_RG_HP10Xv332)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10Xv332 ~ GT_weighted__HG004_PB_30x_RG_HP10Xv332)+xlim(c(0,300))+ylim(c(0,300))
#ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_ref_HG004_PB_30x_RG_HP10Xv332)), y=as.integer(as.character(weighted_count_alt_HG004_PB_30x_RG_HP10Xv332)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10Xv332 ~ GT_weighted__HG003_PB_30x_RG_HP10Xv332)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)+xlim(c(0,1))+ylim(c(0,1))
ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10Xv332 ~ GT_weighted__HG004_PB_30x_RG_HP10Xv332)+xlim(c(0,1))+ylim(c(0,1))

ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)
ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)

ggplot(AJpacbioHP10Xtrio332cast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP1))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10Xv332_HP2))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10Xv332_HP2)))) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10Xv332)

#pacbioHP10XtrioRTG by HP
AJpacbioHP10XtrioRTG <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHP10XtrioRTGv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBHP10XtrioRTGv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    #tmp1$key<-sub("^(.).*(_n_indel_low)","\\1\\2",tmp1$key)
    AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset10kto20kMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset10kto20kMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset60kto73164MQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset60kto73164MQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# 
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset1to10kMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset1to10kMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJpacbioHP10XtrioRTG <- rbind(AJpacbioHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }

AJpacbioHP10XtrioRTGcast <- dcast(AJpacbioHP10XtrioRTG[!duplicated(AJpacbioHP10XtrioRTG[,.(id , key , allele , sample)]),], id ~ key + allele + sample,fill=0)
setkey(AJpacbioHP10XtrioRTGcast,"id")

AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG <- ifelse((AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "1/1") | (AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "1/1" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "1/1"),"1/1","./.")))
AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG <- ifelse((AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1") | (AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"1/1","./.")))
AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG <- ifelse((AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1") | (AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1" & AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"1/1","./.")))

contingencytable <- xtabs(~AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG+AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG+AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG, data=AJpacbioHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))

AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG_HP1 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG_HP2 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG <- pmin(AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG_HP1,AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG_HP2)*4
AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP1 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP2 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG <- pmin(AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP1,AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP2)*4
AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP1 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP2 <- ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJpacbioHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG <- pmin(AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP1,AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP2)*4

sum(AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG=="./.")

contingencytable <- xtabs(~AJpacbioHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG+(AJpacbioHP10XtrioRTGcast$GQ_HG002_PB_70x_RG_HP10XtrioRTG>=40 & AJpacbioHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG>=40 & AJpacbioHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG>=40)+AJpacbioHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG+AJpacbioHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG, data=AJpacbioHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJpacbioHP10XtrioRTGcast, aes(x=GQ_HG002_PB_70x_RG_HP10XtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=GQ_HG003_PB_30x_RG_HP10XtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG)
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=GQ_HG004_PB_30x_RG_HP10XtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,60))+ylim(c(0,60))
#ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_PB_30x_RG_HP10XtrioRTG)), y=as.integer(as.character(weighted_count_alt_HG003_PB_30x_RG_HP10XtrioRTG)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,300))+ylim(c(0,300))
#ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_PB_30x_RG_HP10XtrioRTG)), y=as.integer(as.character(weighted_count_alt_HG004_PB_30x_RG_HP10XtrioRTG)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG ~ GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))

ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)
ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)

ggplot(AJpacbioHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP2))+as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP2)))) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)


#Ill250bp
AJIll250bp <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIll250bp <- rbind(AJIll250bp,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIll250bp <- rbind(AJIll250bp,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1Ill250bpv0502techor4callsetMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1Ill250bpv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIll250bp <- rbind(AJIll250bp,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1250bpv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIll250bp <- rbind(AJIll250bp,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

AJIll250bpcast <- dcast(AJIll250bp, id ~ key + allele + sample,fill=0)
setkey(AJIll250bpcast,"id")
contingencytable <- xtabs(~AJIll250bpcast$GT_weighted__HG002_Ill_250bp_45x+AJIll250bpcast$GT_weighted__HG003_Ill_250bp_45x+AJIll250bpcast$GT_weighted__HG004_Ill_250bp_45x, data=AJIll250bpcast)
ftable(contingencytable,row.vars=c(1))

AJIll250bpcast$GQ_HG002_Ill_250bp_45x <- ifelse(AJIll250bpcast$GT_weighted__HG002_Ill_250bp_45x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG002_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG002_Ill_250bp_45x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG002_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG002_Ill_250bp_45x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIll250bpcast$GQ_weighted__HG002_Ill_250bp_45x,perl = TRUE),perl = TRUE))),0)))
AJIll250bpcast$GQ_HG003_Ill_250bp_45x <- ifelse(AJIll250bpcast$GT_weighted__HG003_Ill_250bp_45x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG003_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG003_Ill_250bp_45x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG003_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG003_Ill_250bp_45x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIll250bpcast$GQ_weighted__HG003_Ill_250bp_45x,perl = TRUE),perl = TRUE))),0)))
AJIll250bpcast$GQ_HG004_Ill_250bp_45x <- ifelse(AJIll250bpcast$GT_weighted__HG004_Ill_250bp_45x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG004_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG004_Ill_250bp_45x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIll250bpcast$GQ_weighted__HG004_Ill_250bp_45x,perl = TRUE),perl = TRUE))),ifelse(AJIll250bpcast$GT_weighted__HG004_Ill_250bp_45x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIll250bpcast$GQ_weighted__HG004_Ill_250bp_45x,perl = TRUE),perl = TRUE))),0)))

contingencytable <- xtabs(~AJIll250bpcast$GT_weighted__HG002_Ill_250bp_45x+(AJIll250bpcast$GQ_HG002_Ill_250bp_45x>=40 & AJIll250bpcast$GQ_HG003_Ill_250bp_45x>=40 & AJIll250bpcast$GQ_HG004_Ill_250bp_45x>=40)+AJIll250bpcast$GT_weighted__HG003_Ill_250bp_45x+AJIll250bpcast$GT_weighted__HG004_Ill_250bp_45x, data=AJIll250bpcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJIll250bpcast, aes(x=GQ_HG002_Ill_250bp_45x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_Ill_250bp_45x)
ggplot(AJIll250bpcast, aes(x=GQ_HG003_Ill_250bp_45x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_Ill_250bp_45x)
ggplot(AJIll250bpcast, aes(x=GQ_HG004_Ill_250bp_45x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_Ill_250bp_45x)
ggplot(AJIll250bpcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_250bp_45x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(  ~ GT_weighted__HG002_Ill_250bp_45x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJIll250bpcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_250bp_45x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid( GT_weighted__HG003_Ill_250bp_45x ~ GT_weighted__HG004_Ill_250bp_45x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJIll250bpcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_Ill_250bp_45x)), y=as.integer(as.character(weighted_count_alt_HG003_Ill_250bp_45x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_250bp_45x ~ GT_weighted__HG004_Ill_250bp_45x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJIll250bpcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_Ill_250bp_45x)), y=as.integer(as.character(weighted_count_alt_HG004_Ill_250bp_45x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_250bp_45x ~ GT_weighted__HG003_Ill_250bp_45x)+xlim(c(0,100))+ylim(c(0,100))


#IllMP
AJIllMP <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv0502techor4callsetgt299MQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv0502techor4callsetgt299MQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIllMP <- rbind(AJIllMP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIllMP <- rbind(AJIllMP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1IllMPv0502techor4callsetgt299MQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1IllMPv0502techor4callsetgt299MQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIllMP <- rbind(AJIllMP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1MPv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJIllMP <- rbind(AJIllMP,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

AJIllMPcast <- dcast(AJIllMP, id ~ key + allele + sample,fill=0)
setkey(AJIllMPcast,"id")
contingencytable <- xtabs(~AJIllMPcast$GT_weighted__HG002_Ill_6kbMP_15x+AJIllMPcast$GT_weighted__HG003_Ill_6kbMP_15x+AJIllMPcast$GT_weighted__HG004_Ill_6kbMP_15x, data=AJIllMPcast)
ftable(contingencytable,row.vars=c(1))

AJIllMPcast$GQ_HG002_Ill_6kbMP_15x <- ifelse(AJIllMPcast$GT_weighted__HG002_Ill_6kbMP_15x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG002_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG002_Ill_6kbMP_15x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG002_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG002_Ill_6kbMP_15x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIllMPcast$GQ_weighted__HG002_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),0)))
AJIllMPcast$GQ_HG003_Ill_6kbMP_15x <- ifelse(AJIllMPcast$GT_weighted__HG003_Ill_6kbMP_15x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG003_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG003_Ill_6kbMP_15x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG003_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG003_Ill_6kbMP_15x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIllMPcast$GQ_weighted__HG003_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),0)))
AJIllMPcast$GQ_HG004_Ill_6kbMP_15x <- ifelse(AJIllMPcast$GT_weighted__HG004_Ill_6kbMP_15x== "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG004_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG004_Ill_6kbMP_15x == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJIllMPcast$GQ_weighted__HG004_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),ifelse(AJIllMPcast$GT_weighted__HG004_Ill_6kbMP_15x == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJIllMPcast$GQ_weighted__HG004_Ill_6kbMP_15x,perl = TRUE),perl = TRUE))),0)))

contingencytable <- xtabs(~AJIllMPcast$GT_weighted__HG002_Ill_6kbMP_15x+(AJIllMPcast$GQ_HG002_Ill_6kbMP_15x>=40 & AJIllMPcast$GQ_HG003_Ill_6kbMP_15x>=40 & AJIllMPcast$GQ_HG004_Ill_6kbMP_15x>=40)+AJIllMPcast$GT_weighted__HG003_Ill_6kbMP_15x+AJIllMPcast$GT_weighted__HG004_Ill_6kbMP_15x, data=AJIllMPcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJIllMPcast, aes(x=GQ_HG002_Ill_6kbMP_15x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_Ill_6kbMP_15x)
ggplot(AJIllMPcast, aes(x=GQ_HG003_Ill_6kbMP_15x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_Ill_6kbMP_15x)
ggplot(AJIllMPcast, aes(x=GQ_HG004_Ill_6kbMP_15x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_Ill_6kbMP_15x)
ggplot(AJIllMPcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_Ill_6kbMP_15x)+xlim(c(0,300))+ylim(c(0,300))
ggplot(AJIllMPcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_Ill_6kbMP_15x ~ GT_weighted__HG004_Ill_6kbMP_15x)+xlim(c(0,300))+ylim(c(0,300))
ggplot(AJIllMPcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG003_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_6kbMP_15x ~ GT_weighted__HG004_Ill_6kbMP_15x)+xlim(c(0,300))+ylim(c(0,300))
ggplot(AJIllMPcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG004_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_6kbMP_15x ~ GT_weighted__HG003_Ill_6kbMP_15x)+xlim(c(0,100))+ylim(c(0,100))



#10X
AJ10X <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJ10X <- rbind(AJ10X,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv050nabsysorbionanoMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJ10X <- rbind(AJ10X,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv0502techor4callsetMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJ10X <- rbind(AJ10X,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110Xv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    AJ10X <- rbind(AJ10X,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}

#AJ10Xcast <- data.table(cast(AJ10X, samplenoHP + id ~ allele + key + HP,fill=0),key="id")

AJ10Xcast <- dcast(AJ10X, id ~ key + allele + sample,fill=0)
setkey(AJ10Xcast,"id")

AJ10Xcast$GT_weighted__HG002_10X_86x <- ifelse((AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "0/0" & AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "1/1") | (AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "1/1"),"0/1", ifelse( (AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "0/0"),"0/0", ifelse( (AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "1/1" & AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "1/1"),"1/1","./.")))
AJ10Xcast$GT_weighted__HG003_10X_36x <- ifelse((AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "0/0" & AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "1/1") | (AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "1/1"),"0/1", ifelse( (AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "0/0"),"0/0", ifelse( (AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "1/1" & AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "1/1"),"1/1","./.")))
AJ10Xcast$GT_weighted__HG004_10X_47x <- ifelse((AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "0/0" & AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "1/1") | (AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "1/1"),"0/1", ifelse( (AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "0/0" & AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "0/0"),"0/0", ifelse( (AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "1/1" & AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "1/1"),"1/1","./.")))

contingencytable <- xtabs(~AJ10Xcast$GT_weighted__HG002_10X_86x+AJ10Xcast$GT_weighted__HG003_10X_36x+AJ10Xcast$GT_weighted__HG004_10X_47x, data=AJ10Xcast)
ftable(contingencytable,row.vars=c(1))

AJ10Xcast$GQ_HG002_10X_86x_HP1 <- ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG002_10X_86x_HP2 <- ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG002_10X_86x_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG002_10X_86x_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG002_10X_86x <- pmin(AJ10Xcast$GQ_HG002_10X_86x_HP1,AJ10Xcast$GQ_HG002_10X_86x_HP2)*4
AJ10Xcast$GQ_HG003_10X_36x_HP1 <- ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG003_10X_36x_HP2 <- ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG003_10X_36x_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG003_10X_36x_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG003_10X_36x <- pmin(AJ10Xcast$GQ_HG003_10X_36x_HP1,AJ10Xcast$GQ_HG003_10X_36x_HP2)*4
AJ10Xcast$GQ_HG004_10X_47x_HP1 <- ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG004_10X_47x_HP2 <- ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10Xcast$GT_weighted__HG004_10X_47x_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10Xcast$GQ_weighted__HG004_10X_47x_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10Xcast$GQ_HG004_10X_47x <- pmin(AJ10Xcast$GQ_HG004_10X_47x_HP1,AJ10Xcast$GQ_HG004_10X_47x_HP2)*4

contingencytable <- xtabs(~AJ10Xcast$GT_weighted__HG002_10X_86x+(AJ10Xcast$GQ_HG002_10X_86x>=40 & AJ10Xcast$GQ_HG003_10X_36x>=40 & AJ10Xcast$GQ_HG004_10X_47x>=40)+AJ10Xcast$GT_weighted__HG003_10X_36x+AJ10Xcast$GT_weighted__HG004_10X_47x, data=AJ10Xcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJ10Xcast, aes(x=GQ_HG002_10X_86x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_10X_86x)
ggplot(AJ10Xcast, aes(x=GQ_HG003_10X_36x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_10X_36x)
ggplot(AJ10Xcast, aes(x=GQ_HG004_10X_47x)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_10X_47x)
ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_10X_86x)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_10X_36x ~ GT_weighted__HG004_10X_47x)+xlim(c(0,60))+ylim(c(0,60))
#ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_10X_36x)), y=as.integer(as.character(weighted_count_alt_HG003_10X_36x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_10X_86x ~ GT_weighted__HG004_10X_47x)+xlim(c(0,300))+ylim(c(0,300))
#ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_10X_47x)), y=as.integer(as.character(weighted_count_alt_HG004_10X_47x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_10X_86x ~ GT_weighted__HG003_10X_36x)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_10X_86x)+xlim(c(0,1))+ylim(c(0,1))
ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_10X_36x ~ GT_weighted__HG004_10X_47x)+xlim(c(0,1))+ylim(c(0,1))

ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_10X_86x)
ggplot(AJ10Xcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_10X_86x)

#AJ10Xcast$Both10XHPHet <- (AJ10Xcast$`_GT_weighted_HP1` == "0/1" & AJ10Xcast$`_GT_weighted_HP2` == "0/1")


#10xHP10XtrioRTG by HP
AJ10xHP10XtrioRTG <- data.table()
for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110xHP10XtrioRTGv0502techor4callsetMQ20/",pattern="tsv")) {
  tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a110xHP10XtrioRTGv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
  if (nrow(tmp1)>0) {
    tmp1$id<-i
    #tmp1$key<-sub("^(.).*(_n_indel_low)","\\1\\2",tmp1$key)
    AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
  }
}
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset10kto20kMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset10kto20kMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset60kto73164MQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset60kto73164MQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# 
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset1to10kMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callset1to10kMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv0502techor4callsetMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }
# for(i in list.files("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20HG34/",pattern="tsv")) {
#   tmp1<-fread((paste0("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/genosv20a1PBbioHP10XtrioRTGv050nabsysorbionanoMQ20HG34/",i)), header = TRUE, sep = "\t")
#   if (nrow(tmp1)>0) {
#     tmp1$id<-i
#     AJ10xHP10XtrioRTG <- rbind(AJ10xHP10XtrioRTG,tmp1[tmp1$key=="weighted_count" | tmp1$key=="GT_weighted" | tmp1$key=="GQ_weighted",])
#   }
# }

AJ10xHP10XtrioRTGcast <- dcast(AJ10xHP10XtrioRTG[!duplicated(AJ10xHP10XtrioRTG[,.(id , key , allele , sample)]),], id ~ key + allele + sample,fill=0)
setkey(AJ10xHP10XtrioRTGcast,"id")

AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG <- ifelse((AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "1/1") | (AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "1/1" & AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "1/1"),"1/1","./.")))
AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG <- ifelse((AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1") | (AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1" & AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"1/1","./.")))
AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG <- ifelse((AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1") | (AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"0/1", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0" & AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0"),"0/0", ifelse( (AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1" & AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1"),"1/1","./.")))

contingencytable <- xtabs(~AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG+AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG+AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG, data=AJ10xHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))

AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG_HP1 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG_HP2 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG002_10x_84x_RG_HP10xtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG <- pmin(AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG_HP1,AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG_HP2)*4
AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP1 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP2 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG003_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG <- pmin(AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP1,AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG_HP2)*4
AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP1 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP1,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP2 <- ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/0", as.numeric(as.character(gsub("\\[(.*e...).*e.*e.*","\\1",gsub("\\[ (.*[0-9]\\..*) (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "0/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* (.*[0-9]\\..*)[0-9]\\..*","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),ifelse(AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2 == "1/1", as.numeric(as.character(gsub("\\[.*e...(.*e...).*e.*","\\1",gsub("\\[ .*[0-9]\\..* .*[0-9]\\..* (.*[0-9]\\..*)\\]","\\1",AJ10xHP10XtrioRTGcast$GQ_weighted__HG004_PB_30x_RG_HP10XtrioRTG_HP2,perl = TRUE),perl = TRUE))),0)))
AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG <- pmin(AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP1,AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG_HP2)*4

sum(AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG=="./.")

contingencytable <- xtabs(~AJ10xHP10XtrioRTGcast$GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG+(AJ10xHP10XtrioRTGcast$GQ_HG002_10x_84x_RG_HP10xtrioRTG>=40 & AJ10xHP10XtrioRTGcast$GQ_HG003_PB_30x_RG_HP10XtrioRTG>=40 & AJ10xHP10XtrioRTGcast$GQ_HG004_PB_30x_RG_HP10XtrioRTG>=40)+AJ10xHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG+AJ10xHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG, data=AJ10xHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))

ggplot(AJ10xHP10XtrioRTGcast, aes(x=GQ_HG002_10x_84x_RG_HP10xtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)
ggplot(AJ10xHP10XtrioRTGcast, aes(x=GQ_HG003_PB_30x_RG_HP10XtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG)
ggplot(AJ10xHP10XtrioRTGcast, aes(x=GQ_HG004_PB_30x_RG_HP10XtrioRTG)) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)
ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)+xlim(c(0,60))+ylim(c(0,60))
ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,60))+ylim(c(0,60))
#ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG003_PB_30x_RG_HP10XtrioRTG)), y=as.integer(as.character(weighted_count_alt_HG003_PB_30x_RG_HP10XtrioRTG)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,300))+ylim(c(0,300))
#ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_ref_HG004_PB_30x_RG_HP10XtrioRTG)), y=as.integer(as.character(weighted_count_alt_HG004_PB_30x_RG_HP10XtrioRTG)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG ~ GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,100))+ylim(c(0,100))
ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_PB_30x_RG_HP10XtrioRTG ~ GT_weighted__HG004_PB_30x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))

ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)
ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP2))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))))) +  geom_histogram(binwidth=0.02,colour="white") + facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)

ggplot(AJ10xHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP2))+as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP2)))) +  geom_histogram(binwidth=5,colour="white") + facet_grid(  ~ GT_weighted__HG002_10x_84x_RG_HP10xtrioRTG)

DTAJmergeHP10XtrioRTGcast <- merge(AJ10Xcast,merge(AJpacbioHPcast, merge(AJ10xHP10XtrioRTGcast,AJpacbioHP10XtrioRTGcast,sort=FALSE,by=c("id"),all=FALSE,suffixes=c(".HP10x",".HPPB")),sort=FALSE,by=c("id"),all=FALSE,suffixes=c(".HPPBold","")),sort=FALSE,by=c("id"),all=FALSE,suffixes=c(".HP10xold",""))
ggplot(DTAJmergeHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmergeHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmergeHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10x_84x_RG_HP10xtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_10x_84x_RG_HP10xtrioRTG_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmergeHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XtrioRTG_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmergeHP10XtrioRTGcast, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XtrioRTG_HP1)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG)+xlim(c(0,50))+ylim(c(0,50))

contingencytable <- xtabs(~DTAJmergeHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP1 + DTAJmergeHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS + DTAJmergeHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS, data=DTAJmergeHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))
contingencytable <- xtabs(~DTAJmergeHP10XtrioRTGcast$GT_weighted__HG002_PB_70x_RG_HP10XtrioRTG_HP2 + DTAJmergeHP10XtrioRTGcast$GT_weighted__HG003_PB_30x_RG_HP10XPASS + DTAJmergeHP10XtrioRTGcast$GT_weighted__HG004_PB_30x_RG_HP10XPASS, data=DTAJmergeHP10XtrioRTGcast)
ftable(contingencytable,row.vars=c(1))


#Merge svviz techs and v0.5 calls
DTAJmerge <- merge(AJIllMPcast,merge(AJIll250bpcast,merge(AJ10Xcast,merge(AJpacbiocast,AJpacbioHPcast,sort=FALSE,by=c("id"),all=TRUE,suffixes=c(".pacbio",".pacbioHP")),sort=FALSE,by=c("id"),all=TRUE,suffixes=c(".10X","")),sort=FALSE,by=c("id"),all=TRUE,suffixes=c(".Ill250bp","")),sort=FALSE,by=c("id"),all=TRUE,suffixes=c(".IllMP",""))
DTAJmerge$ID <- sub("(.*).del.*","\\1",sub("(.*).SequenceDefined.*","\\1",DTAJmerge$id))
DTAJmerge <- merge(svcompthresh2bionanonabsys,DTAJmerge,by="ID")
# DTAJmerge[is.na(DTAJmerge$GQ1.pacbio),]$GQ1.pacbio=-1
# DTAJmerge[is.na(DTAJmerge$GT1.pacbio),]$GT1.pacbio="."
# DTAJmerge[is.na(DTAJmerge$GQ1.10X),"GQ1.10X"]=-1
# DTAJmerge[is.na(DTAJmerge$GT1.10X),"GT1.10X"]="."
# DTAJmerge[is.na(DTAJmerge$GQ1.IllMP),"GQ1.IllMP"]=-1
# DTAJmerge[is.na(DTAJmerge$GT1.IllMP),"GT1.IllMP"]="."
# DTAJmerge[is.na(DTAJmerge$GQ1),"GQ1"]=-1
# DTAJmerge[is.na(DTAJmerge$GT1),"GT1"]="."

DTAJmerge$GT_weighted__HG002_PB_70x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x) & DTAJmerge$GQ_HG002_PB_70x>=40,DTAJmerge$GT_weighted__HG002_PB_70x,"./.")
DTAJmerge$GT_weighted__HG003_PB_30x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x) & DTAJmerge$GQ_HG003_PB_30x>=40,DTAJmerge$GT_weighted__HG003_PB_30x,"./.")
DTAJmerge$GT_weighted__HG004_PB_30x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x) & DTAJmerge$GQ_HG004_PB_30x>=40,DTAJmerge$GT_weighted__HG004_PB_30x,"./.")

DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS) & DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS>=40,DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS,"./.")
DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS) & DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS>=40,DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS,"./.")
DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS) & DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS>=40,DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS,"./.")

DTAJmerge$GT_weighted__HG002_10X_86x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x) & DTAJmerge$GQ_HG002_10X_86x>=40,DTAJmerge$GT_weighted__HG002_10X_86x,"./.")
DTAJmerge$GT_weighted__HG003_10X_36x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x) & DTAJmerge$GQ_HG003_10X_36x>=40,DTAJmerge$GT_weighted__HG003_10X_36x,"./.")
DTAJmerge$GT_weighted__HG004_10X_47x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x) & DTAJmerge$GQ_HG004_10X_47x>=40,DTAJmerge$GT_weighted__HG004_10X_47x,"./.")

DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_6kbMP_15x) & DTAJmerge$GQ_HG002_Ill_6kbMP_15x>=40,DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x,"./.")
DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_6kbMP_15x) & DTAJmerge$GQ_HG003_Ill_6kbMP_15x>=40,DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x,"./.")
DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_6kbMP_15x) & DTAJmerge$GQ_HG004_Ill_6kbMP_15x>=40,DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x,"./.")

DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_250bp_45x) & DTAJmerge$GQ_HG002_Ill_250bp_45x>=40,DTAJmerge$GT_weighted__HG002_Ill_250bp_45x,"./.")
DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_250bp_45x) & DTAJmerge$GQ_HG003_Ill_250bp_45x>=40,DTAJmerge$GT_weighted__HG003_Ill_250bp_45x,"./.")
DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ <- ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_250bp_45x) & DTAJmerge$GQ_HG004_Ill_250bp_45x>=40,DTAJmerge$GT_weighted__HG004_Ill_250bp_45x,"./.")

#calc GT based on ref and alt counts to better genotype large variants
DTAJmerge$GT_weighted__HG002_PB_70x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x)))<0.1,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x)))>0.9,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x)))>0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x)))<0.75,"0/1","./.")))
DTAJmerge$GT_weighted__HG003_PB_30x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x)))<0.1,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x)))>0.9,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x)))>0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x)))<0.75,"0/1","./.")))
DTAJmerge$GT_weighted__HG004_PB_30x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x)))<0.1,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x)))>0.9,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x)))>0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x)))<0.75,"0/1","./.")))

DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))>0.75) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))<0.25))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))>0.75) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))<0.25))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))>0.75) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))>0.75 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))<0.25))),"0/1","./.")))

DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_PB_70x_RG_HP10XPASS_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1=="1/1","1|0",""))
DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_PB_30x_RG_HP10XPASS_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1=="1/1","1|0",""))
DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))<0.25,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))>0.75,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_PB_30x_RG_HP10XPASS_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))<0.25) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)))>0.75))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1=="1/1","1|0",""))

DTAJmerge$GT_weighted__HG002_10X_86x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))>0.95) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))<0.05))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_10X_36x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))>0.95) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))<0.05))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_10X_47x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))<0.05 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))>0.95) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))>0.95 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))<0.05))),"0/1","./.")))

DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP1)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_10X_86x_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_10X_86x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_10X_86x_HP2)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG002_10X_86x_HQ2_HP1=="1/1","1|0",""))
DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP1)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_10X_36x_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_10X_36x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_10X_36x_HP2)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG003_10X_36x_HQ2_HP1=="1/1","1|0",""))
DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP1 <- ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP1) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP1))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP1)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP2) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_10X_47x_HP2) & (((as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))<0.05) | (as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2))>=5 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_10X_47x_HP2))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_10X_47x_HP2)))>0.95))),"0/1","./.")))
DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_phased <- ifelse(DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP1=="0/0" & DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP2=="1/1","0|1",ifelse(DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP2=="0/0" & DTAJmerge$GT_weighted__HG004_10X_47x_HQ2_HP1=="1/1","1|0",""))

DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_6kbMP_15x)))<0.90,"0/1","./.")))
DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_6kbMP_15x)))<0.90,"0/1","./.")))
DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_6kbMP_15x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_6kbMP_15x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_6kbMP_15x)))<0.90,"0/1","./.")))

DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG002_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG002_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG002_Ill_250bp_45x)))<0.90,"0/1","./.")))
DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG003_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG003_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG003_Ill_250bp_45x)))<0.90,"0/1","./.")))
DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ2 <- ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x)))<0.05,"0/0",ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x)))>0.95,"1/1",ifelse(!is.na(DTAJmerge$GQ_HG004_Ill_250bp_45x) & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x))>=8 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x)))>0.10 & as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))/(as.integer(as.character(DTAJmerge$weighted_count_alt_HG004_Ill_250bp_45x))+as.integer(as.character(DTAJmerge$weighted_count_ref_HG004_Ill_250bp_45x)))<0.90,"0/1","./.")))


DTAJmerge$GTHomVarCnt_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

DTAJmerge$GTHomVarCnt_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

DTAJmerge$GTHomVarCnt_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

summary(DTAJmerge$GTHetCnt_HG002)
DTAJmerge$GTcons_HG002 <- ifelse(DTAJmerge$GTHomVarCnt_HG002>0 & DTAJmerge$GTHetCnt_HG002==0 & DTAJmerge$GTHomRefCnt_HG002==0 & DTAJmerge$HG2count>0,"1/1",ifelse(DTAJmerge$GTHomVarCnt_HG002==0 & DTAJmerge$GTHetCnt_HG002>0 & DTAJmerge$GTHomRefCnt_HG002==0 & (DTAJmerge$HG2count>0 | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))),"0/1",ifelse(DTAJmerge$GTHomVarCnt_HG002==0 & DTAJmerge$GTHetCnt_HG002==0 & DTAJmerge$GTHomRefCnt_HG002>0,"0/0","./.")))
DTAJmerge$GTsupp_HG002 <- ifelse(DTAJmerge$GTHomVarCnt_HG002>0 & DTAJmerge$GTHetCnt_HG002==0 & DTAJmerge$GTHomRefCnt_HG002==0,DTAJmerge$GTHomVarCnt_HG002,ifelse(DTAJmerge$GTHomVarCnt_HG002==0 & DTAJmerge$GTHetCnt_HG002>0 & DTAJmerge$GTHomRefCnt_HG002==0,DTAJmerge$GTHetCnt_HG002,ifelse(DTAJmerge$GTHomVarCnt_HG002==0 & DTAJmerge$GTHetCnt_HG002==0 & DTAJmerge$GTHomRefCnt_HG002>0,DTAJmerge$GTHomRefCnt_HG002,0)))
DTAJmerge$GTcons_HG003 <- ifelse(DTAJmerge$GTHomVarCnt_HG003>0 & DTAJmerge$GTHetCnt_HG003==0 & DTAJmerge$GTHomRefCnt_HG003==0 & DTAJmerge$HG3count>0,"1/1",ifelse(DTAJmerge$GTHomVarCnt_HG003==0 & DTAJmerge$GTHetCnt_HG003>0 & DTAJmerge$GTHomRefCnt_HG003==0 & DTAJmerge$HG3count>0,"0/1",ifelse(DTAJmerge$GTHomVarCnt_HG003==0 & DTAJmerge$GTHetCnt_HG003==0 & DTAJmerge$GTHomRefCnt_HG003>0,"0/0","./.")))
DTAJmerge$GTsupp_HG003 <- ifelse(DTAJmerge$GTHomVarCnt_HG003>0 & DTAJmerge$GTHetCnt_HG003==0 & DTAJmerge$GTHomRefCnt_HG003==0,DTAJmerge$GTHomVarCnt_HG003,ifelse(DTAJmerge$GTHomVarCnt_HG003==0 & DTAJmerge$GTHetCnt_HG003>0 & DTAJmerge$GTHomRefCnt_HG003==0,DTAJmerge$GTHetCnt_HG003,ifelse(DTAJmerge$GTHomVarCnt_HG003==0 & DTAJmerge$GTHetCnt_HG003==0 & DTAJmerge$GTHomRefCnt_HG003>0,DTAJmerge$GTHomRefCnt_HG003,0)))
DTAJmerge$GTcons_HG004 <- ifelse(DTAJmerge$GTHomVarCnt_HG004>0 & DTAJmerge$GTHetCnt_HG004==0 & DTAJmerge$GTHomRefCnt_HG004==0 & DTAJmerge$HG4count>0,"1/1",ifelse(DTAJmerge$GTHomVarCnt_HG004==0 & DTAJmerge$GTHetCnt_HG004>0 & DTAJmerge$GTHomRefCnt_HG004==0 & DTAJmerge$HG4count>0,"0/1",ifelse(DTAJmerge$GTHomVarCnt_HG004==0 & DTAJmerge$GTHetCnt_HG004==0 & DTAJmerge$GTHomRefCnt_HG004>0,"0/0","./.")))
DTAJmerge$GTsupp_HG004 <- ifelse(DTAJmerge$GTHomVarCnt_HG004>0 & DTAJmerge$GTHetCnt_HG004==0 & DTAJmerge$GTHomRefCnt_HG004==0,DTAJmerge$GTHomVarCnt_HG004,ifelse(DTAJmerge$GTHomVarCnt_HG004==0 & DTAJmerge$GTHetCnt_HG004>0 & DTAJmerge$GTHomRefCnt_HG004==0,DTAJmerge$GTHetCnt_HG004,ifelse(DTAJmerge$GTHomVarCnt_HG004==0 & DTAJmerge$GTHetCnt_HG004==0 & DTAJmerge$GTHomRefCnt_HG004>0,DTAJmerge$GTHomRefCnt_HG004,0)))

sum(DTAJmerge$GTcons_HG002=="0/0")
sum(DTAJmerge$GTcons_HG002=="0/1")
sum(DTAJmerge$GTcons_HG002=="1/1")
sum(DTAJmerge$GTcons_HG003=="0/0")
sum(DTAJmerge$GTcons_HG003=="0/1")
sum(DTAJmerge$GTcons_HG003=="1/1")
sum(DTAJmerge$GTcons_HG004=="0/0")
sum(DTAJmerge$GTcons_HG004=="0/1")
sum(DTAJmerge$GTcons_HG004=="1/1")

ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_10X_86x_HQ)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2)+xlim(c(0,1))+ylim(c(0,1))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid(  ~ GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2)+xlim(c(0,1))+ylim(c(0,1))

#View(DTAJmerge[as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1))+as.integer(as.character(weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)))<0.25 & as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1)))>0.75, .(CHROM,POS,SVLEN,GT_weighted__HG002_Ill_250bp_45x_HQ,GT_weighted__HG002_Ill_6kbMP_15x_HQ,GT_weighted__HG002_10X_86x_HQ,GT_weighted__HG002_PB_70x_HQ,ClusterIDs)])


#Mendelian errors vs total genotypes
DTAJmerge$MendelianError<-((DTAJmerge$GTcons_HG002=="1/1" | DTAJmerge$GTcons_HG002=="0/1") & DTAJmerge$GTcons_HG003=="0/0" & DTAJmerge$GTcons_HG004=="0/0") | ((DTAJmerge$GTcons_HG002=="1/1" | DTAJmerge$GTcons_HG002=="0/0") & DTAJmerge$GTcons_HG003=="0/0" & DTAJmerge$GTcons_HG004=="1/1") | ((DTAJmerge$GTcons_HG002=="1/1" | DTAJmerge$GTcons_HG002=="0/0") & DTAJmerge$GTcons_HG003=="1/1" & DTAJmerge$GTcons_HG004=="0/0") | ((DTAJmerge$GTcons_HG002=="0/0" | DTAJmerge$GTcons_HG002=="0/1") & DTAJmerge$GTcons_HG003=="1/1" & DTAJmerge$GTcons_HG004=="1/1") | (DTAJmerge$GTcons_HG002=="0/0" & DTAJmerge$GTcons_HG003=="1/1" & DTAJmerge$GTcons_HG004=="0/1") | (DTAJmerge$GTcons_HG002=="0/0" & DTAJmerge$GTcons_HG003=="0/1" & DTAJmerge$GTcons_HG004=="1/1") | (DTAJmerge$GTcons_HG002=="1/1" & DTAJmerge$GTcons_HG003=="0/0" & DTAJmerge$GTcons_HG004=="0/1") | (DTAJmerge$GTcons_HG002=="1/1" & DTAJmerge$GTcons_HG003=="0/1" & DTAJmerge$GTcons_HG004=="0/0")
sum(DTAJmerge$MendelianError)
sum(DTAJmerge$GTcons_HG002!="./." & DTAJmerge$GTcons_HG003!="./." & DTAJmerge$GTcons_HG004!="./.")

contingencytable <- xtabs(~DTAJmerge$GTcons_HG002+DTAJmerge$GTcons_HG003+DTAJmerge$GTcons_HG004, data=DTAJmerge)
ftable(contingencytable,row.vars=c(1))
contingencytable <- xtabs(~DTAJmerge$SVTYPE+DTAJmerge$sizecat+DTAJmerge$GTcons_HG002+DTAJmerge$GTcons_HG003+DTAJmerge$GTcons_HG004, data=DTAJmerge)
ftable(contingencytable,row.vars=c(1,2,3))


#consensus based on ref/alt counts

DTAJmerge$GTHomVarCnt2_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt2_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt2_HG002 <- (DTAJmerge$GT_weighted__HG002_PB_70x_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_10X_86x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG002_Ill_250bp_45x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

DTAJmerge$GTHomVarCnt2_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt2_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt2_HG003 <- (DTAJmerge$GT_weighted__HG003_PB_30x_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_10X_36x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG003_Ill_6kbMP_15x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG003_Ill_250bp_45x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

DTAJmerge$GTHomVarCnt2_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2 == "1/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ2 == "1/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHetCnt2_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2 == "0/1" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ2 == "0/1" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )
DTAJmerge$GTHomRefCnt2_HG004 <- (DTAJmerge$GT_weighted__HG004_PB_30x_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2 == "0/0" & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_10X_47x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup ) + (DTAJmerge$GT_weighted__HG004_Ill_6kbMP_15x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup) + (DTAJmerge$GT_weighted__HG004_Ill_250bp_45x_HQ2 == "0/0" & !(DTAJmerge$TRall & DTAJmerge$SVLEN>49) & !DTAJmerge$TRgt100 & !DTAJmerge$TRgt10k & !DTAJmerge$segdup )

summary(DTAJmerge$GTHetCnt2_HG002)
DTAJmerge$GTcons2_HG002 <- ifelse(DTAJmerge$GTHomVarCnt2_HG002>0 & DTAJmerge$GTHetCnt2_HG002==0 & DTAJmerge$GTHomRefCnt2_HG002==0 & (DTAJmerge$HG2count>0 | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))),"1/1",ifelse(DTAJmerge$GTHomVarCnt2_HG002==0 & DTAJmerge$GTHetCnt2_HG002>0 & DTAJmerge$GTHomRefCnt2_HG002==0 & (DTAJmerge$HG2count>0 | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))),"0/1",ifelse(DTAJmerge$GTHomVarCnt2_HG002==0 & DTAJmerge$GTHetCnt2_HG002==0 & DTAJmerge$GTHomRefCnt2_HG002>0,"0/0",ifelse(DTAJmerge$GTHomVarCnt2_HG002>0 & DTAJmerge$GTHetCnt2_HG002>0 & DTAJmerge$GTHomRefCnt2_HG002==0 & (DTAJmerge$HG2count>0 | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))),"./1","./."))))
DTAJmerge$GTsupp2_HG002 <- ifelse(DTAJmerge$GTHomVarCnt2_HG002>0 & DTAJmerge$GTHetCnt2_HG002==0 & DTAJmerge$GTHomRefCnt2_HG002==0,DTAJmerge$GTHomVarCnt2_HG002,ifelse(DTAJmerge$GTHomVarCnt2_HG002==0 & DTAJmerge$GTHetCnt2_HG002>0 & DTAJmerge$GTHomRefCnt2_HG002==0,DTAJmerge$GTHetCnt2_HG002,ifelse(DTAJmerge$GTHomVarCnt2_HG002==0 & DTAJmerge$GTHetCnt2_HG002==0 & DTAJmerge$GTHomRefCnt2_HG002>0,DTAJmerge$GTHomRefCnt2_HG002,0)))
DTAJmerge$GTcons2_HG003 <- ifelse(DTAJmerge$GTHomVarCnt2_HG003>0 & DTAJmerge$GTHetCnt2_HG003==0 & DTAJmerge$GTHomRefCnt2_HG003==0 & (DTAJmerge$HG3count>0 | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))),"1/1",ifelse(DTAJmerge$GTHomVarCnt2_HG003==0 & DTAJmerge$GTHetCnt2_HG003>0 & DTAJmerge$GTHomRefCnt2_HG003==0 & (DTAJmerge$HG3count>0 | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))),"0/1",ifelse(DTAJmerge$GTHomVarCnt2_HG003==0 & DTAJmerge$GTHetCnt2_HG003==0 & DTAJmerge$GTHomRefCnt2_HG003>0,"0/0",ifelse(DTAJmerge$GTHomVarCnt2_HG003>0 & DTAJmerge$GTHetCnt2_HG003>0 & DTAJmerge$GTHomRefCnt2_HG003==0 & (DTAJmerge$HG3count>0 | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))),"./1","./."))))
DTAJmerge$GTsupp2_HG003 <- ifelse(DTAJmerge$GTHomVarCnt2_HG003>0 & DTAJmerge$GTHetCnt2_HG003==0 & DTAJmerge$GTHomRefCnt2_HG003==0,DTAJmerge$GTHomVarCnt2_HG003,ifelse(DTAJmerge$GTHomVarCnt2_HG003==0 & DTAJmerge$GTHetCnt2_HG003>0 & DTAJmerge$GTHomRefCnt2_HG003==0,DTAJmerge$GTHetCnt2_HG003,ifelse(DTAJmerge$GTHomVarCnt2_HG003==0 & DTAJmerge$GTHetCnt2_HG003==0 & DTAJmerge$GTHomRefCnt2_HG003>0,DTAJmerge$GTHomRefCnt2_HG003,0)))
DTAJmerge$GTcons2_HG004 <- ifelse(DTAJmerge$GTHomVarCnt2_HG004>0 & DTAJmerge$GTHetCnt2_HG004==0 & DTAJmerge$GTHomRefCnt2_HG004==0 & (DTAJmerge$HG4count>0 | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))),"1/1",ifelse(DTAJmerge$GTHomVarCnt2_HG004==0 & DTAJmerge$GTHetCnt2_HG004>0 & DTAJmerge$GTHomRefCnt2_HG004==0 & (DTAJmerge$HG4count>0 | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))),"0/1",ifelse(DTAJmerge$GTHomVarCnt2_HG004==0 & DTAJmerge$GTHetCnt2_HG004==0 & DTAJmerge$GTHomRefCnt2_HG004>0,"0/0",ifelse(DTAJmerge$GTHomVarCnt2_HG004>0 & DTAJmerge$GTHetCnt2_HG004>0 & DTAJmerge$GTHomRefCnt2_HG004==0 & (DTAJmerge$HG4count>0 | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))),"./1","./."))))
DTAJmerge$GTsupp2_HG004 <- ifelse(DTAJmerge$GTHomVarCnt2_HG004>0 & DTAJmerge$GTHetCnt2_HG004==0 & DTAJmerge$GTHomRefCnt2_HG004==0,DTAJmerge$GTHomVarCnt2_HG004,ifelse(DTAJmerge$GTHomVarCnt2_HG004==0 & DTAJmerge$GTHetCnt2_HG004>0 & DTAJmerge$GTHomRefCnt2_HG004==0,DTAJmerge$GTHetCnt2_HG004,ifelse(DTAJmerge$GTHomVarCnt2_HG004==0 & DTAJmerge$GTHetCnt2_HG004==0 & DTAJmerge$GTHomRefCnt2_HG004>0,DTAJmerge$GTHomRefCnt2_HG004,0)))

sum(DTAJmerge$GTcons2_HG002=="0/0")
sum(DTAJmerge$GTcons2_HG002=="0/1")
sum(DTAJmerge$GTcons2_HG002=="1/1")
sum(DTAJmerge$GTcons2_HG002=="./1")
sum(DTAJmerge$GTcons2_HG003=="0/0")
sum(DTAJmerge$GTcons2_HG003=="0/1")
sum(DTAJmerge$GTcons2_HG003=="1/1")
sum(DTAJmerge$GTcons2_HG003=="./1")
sum(DTAJmerge$GTcons2_HG004=="0/0")
sum(DTAJmerge$GTcons2_HG004=="0/1")
sum(DTAJmerge$GTcons2_HG004=="1/1")
sum(DTAJmerge$GTcons2_HG004=="./1")

#Mendelian errors vs total genotypes
sum(((DTAJmerge$GTcons2_HG002=="1/1" | DTAJmerge$GTcons2_HG002=="0/1") & DTAJmerge$GTcons2_HG003=="0/0" & DTAJmerge$GTcons2_HG004=="0/0") | ((DTAJmerge$GTcons2_HG002=="1/1" | DTAJmerge$GTcons2_HG002=="0/0") & DTAJmerge$GTcons2_HG003=="0/0" & DTAJmerge$GTcons2_HG004=="1/1") | ((DTAJmerge$GTcons2_HG002=="1/1" | DTAJmerge$GTcons2_HG002=="0/0") & DTAJmerge$GTcons2_HG003=="1/1" & DTAJmerge$GTcons2_HG004=="0/0") | ((DTAJmerge$GTcons2_HG002=="0/0" | DTAJmerge$GTcons2_HG002=="0/1") & DTAJmerge$GTcons2_HG003=="1/1" & DTAJmerge$GTcons2_HG004=="1/1") | (DTAJmerge$GTcons2_HG002=="0/0" & DTAJmerge$GTcons2_HG003=="1/1" & DTAJmerge$GTcons2_HG004=="0/1") | (DTAJmerge$GTcons2_HG002=="0/0" & DTAJmerge$GTcons2_HG003=="0/1" & DTAJmerge$GTcons2_HG004=="1/1") | (DTAJmerge$GTcons2_HG002=="1/1" & DTAJmerge$GTcons2_HG003=="0/0" & DTAJmerge$GTcons2_HG004=="0/1") | (DTAJmerge$GTcons2_HG002=="1/1" & DTAJmerge$GTcons2_HG003=="0/1" & DTAJmerge$GTcons2_HG004=="0/0"))
sum(DTAJmerge$GTcons2_HG002!="./." & DTAJmerge$GTcons2_HG003!="./." & DTAJmerge$GTcons2_HG004!="./." & DTAJmerge$GTcons2_HG002!="./1" & DTAJmerge$GTcons2_HG003!="./1" & DTAJmerge$GTcons2_HG004!="./1")
contingencytable <- xtabs(~DTAJmerge$GTcons2_HG002+DTAJmerge$GTcons2_HG003+DTAJmerge$GTcons2_HG004, data=DTAJmerge)
ftable(contingencytable,row.vars=c(1))
contingencytable <- xtabs(~DTAJmerge$SVTYPE+DTAJmerge$sizecat+DTAJmerge$GTcons2_HG002+DTAJmerge$GTcons2_HG003+DTAJmerge$GTcons2_HG004, data=DTAJmerge)
ftable(contingencytable,row.vars=c(1,2,3))

ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( ~ GTHomVarCnt_HG002 )+xlim(c(0,50))+ylim(c(0,300))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/10) +facet_grid( SVTYPE + sizecat ~ GT_weighted__HG002_PB_70x_HQ )+xlim(c(0,100))+ylim(c(0,100))
ggplot(DTAJmerge[abs(DTAJmerge$SVLEN)>300,], aes(x=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x))/(as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x))+as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x))), ..density..)) +  geom_histogram(binwidth=.01) + facet_grid( SVTYPE + sizecat ~ GT_weighted__HG002_PB_70x_HQ )
ggplot(DTAJmerge[abs(DTAJmerge$SVLEN)>300,], aes(x=as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(weighted_count_ref_HG002_Ill_250bp_45x))+as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x))), ..density..)) +  geom_histogram(binwidth=.01) + facet_grid( SVTYPE + sizecat ~ GT_weighted__HG002_PB_70x_HQ )
ggplot(DTAJmerge[abs(DTAJmerge$SVLEN)>300,], aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))), ..density..)) +  geom_histogram(binwidth=.01) + facet_grid( SVTYPE + sizecat ~ GT_weighted__HG002_PB_70x_HQ )
ggplot(DTAJmerge[abs(DTAJmerge$SVLEN)>100,], aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x))+as.integer(as.character(weighted_count_alt_HG002_PB_70x))), ..density..)) +  geom_histogram(binwidth=.01) + facet_grid( SVTYPE + sizecat ~ GTcons_HG002 )

ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/30) +facet_grid( GT_weighted__HG003_Ill_6kbMP_15x ~ GT_weighted__HG004_Ill_6kbMP_15x)+xlim(c(0,300))+ylim(c(0,300))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_ref_HG003_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG003_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_6kbMP_15x ~ GT_weighted__HG004_Ill_6kbMP_15x)+xlim(c(0,300))+ylim(c(0,300))
ggplot(DTAJmerge, aes(x=as.integer(as.character(weighted_count_ref_HG004_Ill_6kbMP_15x)), y=as.integer(as.character(weighted_count_alt_HG004_Ill_6kbMP_15x)))) +  geom_point(position=position_jitter(width=.03,height=.03),alpha = 1/100) +facet_grid(GT_weighted__HG002_Ill_6kbMP_15x ~ GT_weighted__HG003_Ill_6kbMP_15x)+xlim(c(0,100))+ylim(c(0,100))


ggplot(DTAJmerge, aes(x=GTsupp_HG002, ..density..)) +  geom_histogram(binwidth=1,colour="white") + facet_grid( GTcons_HG002 ~ SVTYPE + sizecat )
ggplot(DTAJmerge, aes(x=GTsupp2_HG002, ..density..)) +  geom_histogram(binwidth=1,colour="white") + facet_grid( GTcons2_HG002 ~  SVTYPE + sizecat)

#multitech discovered sites in HG2 called 0/0 by PB and at least one other tech
View(DTAJmerge[DTAJmerge$HG2count>0 & DTAJmerge$sizecat=="gt1000" & DTAJmerge$GTcons2_HG002=="0/0" & DTAJmerge$MultiTech & (DTAJmerge$GT_weighted__HG002_PB_70x_HQ2=="0/0") & (DTAJmerge$GTsupp2_HG002>1), .(CHROM,POS,SVLEN,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,BNG_START_HG2INS,BNG_END_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,ClusterIDs)])

ggplot(DTAJmerge, aes(x=BNGLENHG2DELdiffSEQLEN)) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( noHG2 ~ MultiTech)
ggplot(DTAJmerge[!is.na(DTAJmerge$BNG_LEN_HG2DEL),], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/10) + facet_grid( GTcons ~ MultiTech)
ggplot(DTAJmerge[!is.na(DTAJmerge$BNG_LEN_HG2DEL),], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/10) + facet_grid( HG2count ~ MultiTech)
ggplot(DTAJmerge, aes(x=BNGLENHG2INSdiffSEQLEN)) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( noHG2 ~ MultiTech)
ggplot(DTAJmerge[!is.na(DTAJmerge$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/10) + facet_grid( GTcons ~ MultiTech)
ggplot(DTAJmerge[!is.na(DTAJmerge$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/10) + facet_grid( GTcons ~ MultiTech + TR)

View(DTAJmerge[DTAJmerge$BNG_LEN_HG2INS>5000 & DTAJmerge$BNG_LEN_HG2INS<7000,.(CHROM,POS,SVLEN,GTcons,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GT1.pacbio,GQ1.pacbio,GT1.IllMP.HQ,GT1.10X.HQ,GT1.Ill250bp.HQ,GTsupp,ClusterIDs)][order(CHROM,POS)])
awengercurate<-fread(("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_170313/GIAB_v03_Assessment.txt"), header = FALSE, sep = "\t")
awengercuratemerge<-merge(awengercurate,DTAJmerge,by.x="V1",by.y="ID")[order(V3,CHROM,POS)]
View(awengercuratemerge[,.(CHROM,POS,SVLEN,V1,V2,V3,V4,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,ClusterIDs)])

#New PASS site heuristics for v0.5.0
sum(DTAJmerge$SVLEN> 50 & DTAJmerge$SVLEN> 0 )
sum(DTAJmerge$SVLEN> 50 & DTAJmerge$SVLEN> 0 & !(DTAJmerge$GT_weighted__HG002_PB_70x == "0/0" & DTAJmerge$GT_weighted__HG003_PB_30x == "0/0" & DTAJmerge$GT_weighted__HG004_PB_30x == "0/0") & (((DTAJmerge$GTsupp_HG002>0 & (DTAJmerge$GTcons_HG002=="0/1" | DTAJmerge$GTcons_HG002=="1/1")) | (DTAJmerge$GTsupp_HG003>0 & (DTAJmerge$GTcons_HG003=="0/1" | DTAJmerge$GTcons_HG003=="1/1")) | (DTAJmerge$GTsupp_HG004>0 & (DTAJmerge$GTcons_HG004=="0/1" | DTAJmerge$GTcons_HG004=="1/1")) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$svm_score) & DTAJmerge$svm_score>0.9))),na.rm=TRUE)
sum(DTAJmerge$SVLEN> 50 & DTAJmerge$SVLEN> 0 & !(DTAJmerge$GT_weighted__HG002_PB_70x == "0/0" & DTAJmerge$GT_weighted__HG003_PB_30x == "0/0" & DTAJmerge$GT_weighted__HG004_PB_30x == "0/0") & (((DTAJmerge$GTsupp2_HG002>0 & (DTAJmerge$GTcons2_HG002=="0/1" | DTAJmerge$GTcons2_HG002=="1/1")) | (DTAJmerge$GTsupp2_HG003>0 & (DTAJmerge$GTcons2_HG003=="0/1" | DTAJmerge$GTcons2_HG003=="1/1")) | (DTAJmerge$GTsupp2_HG004>0 & (DTAJmerge$GTcons2_HG004=="0/1" | DTAJmerge$GTcons2_HG004=="1/1")) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$svm_score) & DTAJmerge$svm_score>0.9))),na.rm=TRUE)
DTAJmergetrioPASS <- DTAJmerge[!(DTAJmerge$GT_weighted__HG002_PB_70x == "0/0" & DTAJmerge$GT_weighted__HG003_PB_30x == "0/0" & DTAJmerge$GT_weighted__HG004_PB_30x == "0/0") & (((DTAJmerge$HG2count>0 & (DTAJmerge$GTcons2_HG002=="0/1" | DTAJmerge$GTcons2_HG002=="1/1" | DTAJmerge$GTcons2_HG002=="./1")) | (DTAJmerge$HG3count>0 & (DTAJmerge$GTcons2_HG003=="0/1" | DTAJmerge$GTcons2_HG003=="1/1" | DTAJmerge$GTcons2_HG003=="./1")) | (DTAJmerge$HG4count>0 & (DTAJmerge$GTcons2_HG004=="0/1" | DTAJmerge$GTcons2_HG004=="1/1" | DTAJmerge$GTcons2_HG004=="./1")) | (!is.na(DTAJmerge$BNG_LEN_HG4INS) & DTAJmerge$BNGLENHG4INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG4DEL) & DTAJmerge$BNGLENHG4DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG3INS) & DTAJmerge$BNGLENHG3INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG3DEL) & DTAJmerge$BNGLENHG3DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$BNG_LEN_HG2INS) & DTAJmerge$BNGLENHG2INSdiffSEQLEN<log10(300))  | (!is.na(DTAJmerge$BNG_LEN_HG2DEL) & DTAJmerge$BNGLENHG2DELdiffSEQLEN<log10(300)) | (!is.na(DTAJmerge$svm_score) & DTAJmerge$svm_score>0.9))),][order(CHROM,POS)]
DTAJmergetrioPASS$PASStrio=TRUE
DTAJmergetrioPASS$DistPASSBack<-c(99999,DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$POS-DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$POS-nchar(DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1)]$REF))
DTAJmergetrioPASS$DistPASSForward<-c(DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$POS-DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$POS-nchar(DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1)]$REF),99999)
DTAJmergetrioPASS$DistPASSMin<-pmin(DTAJmergetrioPASS$DistPASSBack,DTAJmergetrioPASS$DistPASSForward)
DTAJmergetrioPASS$DistPASSMinlt1000<-(DTAJmergetrioPASS$DistPASSMin<1000)
DTAJmergetrioPASS$CompoundHet_PB_HG002<-c(FALSE,DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$DistPASSBack<1000 & ((DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="0|1" & DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="1|0") | (DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="1|0" & DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="0|1") ))
DTAJmergetrioPASS$CompoundHet_PB_HG002<-c(DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$CompoundHet_PB_HG002,FALSE) | DTAJmergetrioPASS$CompoundHet_PB_HG002
DTAJmergetrioPASS$CompoundHet_10X_HG002<-c(FALSE,DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$DistPASSBack<1000 & ((DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$GT_weighted__HG002_10X_86x_HQ2_phased=="0|1" & DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$GT_weighted__HG002_10X_86x_HQ2_phased=="1|0") | (DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$GT_weighted__HG002_10X_86x_HQ2_phased=="1|0" & DTAJmergetrioPASS[1:(nrow(DTAJmergetrioPASS)-1),]$GT_weighted__HG002_10X_86x_HQ2_phased=="0|1") ))
DTAJmergetrioPASS$CompoundHet_10X_HG002<-c(DTAJmergetrioPASS[2:nrow(DTAJmergetrioPASS),]$CompoundHet_10X_HG002,FALSE) | DTAJmergetrioPASS$CompoundHet_10X_HG002
sum(DTAJmergetrioPASS$CompoundHet_PB_HG002 | DTAJmergetrioPASS$CompoundHet_10X_HG002)
#if no GT or partial GT, then assign PBHP or PB GT
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG002=="./." | DTAJmergetrioPASS$GTcons2_HG002=="./1") & DTAJmergetrioPASS$HG2count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG002<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG002=="./." | DTAJmergetrioPASS$GTcons2_HG002=="./1") & DTAJmergetrioPASS$HG2count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG003=="./." | DTAJmergetrioPASS$GTcons2_HG003=="./1") & DTAJmergetrioPASS$HG3count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG003<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG003=="./." | DTAJmergetrioPASS$GTcons2_HG003=="./1") & DTAJmergetrioPASS$HG3count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG004=="./." | DTAJmergetrioPASS$GTcons2_HG004=="./1") & DTAJmergetrioPASS$HG4count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG004<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG004=="./." | DTAJmergetrioPASS$GTcons2_HG004=="./1") & DTAJmergetrioPASS$HG4count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG002=="./." | DTAJmergetrioPASS$GTcons2_HG002=="./1") & DTAJmergetrioPASS$HG2count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG002<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG002=="./." | DTAJmergetrioPASS$GTcons2_HG002=="./1") & DTAJmergetrioPASS$HG2count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG002_PB_70x_HQ2
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG003=="./." | DTAJmergetrioPASS$GTcons2_HG003=="./1") & DTAJmergetrioPASS$HG3count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG003<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG003=="./." | DTAJmergetrioPASS$GTcons2_HG003=="./1") & DTAJmergetrioPASS$HG3count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG003_PB_30x_HQ2
DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG004=="./." | DTAJmergetrioPASS$GTcons2_HG004=="./1") & DTAJmergetrioPASS$HG4count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GTcons2_HG004<-DTAJmergetrioPASS[(DTAJmergetrioPASS$GTcons2_HG004=="./." | DTAJmergetrioPASS$GTcons2_HG004=="./1") & DTAJmergetrioPASS$HG4count>0 & !DTAJmergetrioPASS$TRgt10k & !DTAJmergetrioPASS$segdup,]$GT_weighted__HG004_PB_30x_HQ2

#Mendelian errors vs total genotypes
DTAJmergetrioPASS$MendelianErrorPASS <-(((DTAJmergetrioPASS$GTcons2_HG002=="1/1" | DTAJmergetrioPASS$GTcons2_HG002=="0/1") & DTAJmergetrioPASS$GTcons2_HG003=="0/0" & DTAJmergetrioPASS$GTcons2_HG004=="0/0") | ((DTAJmergetrioPASS$GTcons2_HG002=="1/1" | DTAJmergetrioPASS$GTcons2_HG002=="0/0") & DTAJmergetrioPASS$GTcons2_HG003=="0/0" & DTAJmergetrioPASS$GTcons2_HG004=="1/1") | ((DTAJmergetrioPASS$GTcons2_HG002=="1/1" | DTAJmergetrioPASS$GTcons2_HG002=="0/0") & DTAJmergetrioPASS$GTcons2_HG003=="1/1" & DTAJmergetrioPASS$GTcons2_HG004=="0/0") | ((DTAJmergetrioPASS$GTcons2_HG002=="0/0" | DTAJmergetrioPASS$GTcons2_HG002=="0/1") & DTAJmergetrioPASS$GTcons2_HG003=="1/1" & DTAJmergetrioPASS$GTcons2_HG004=="1/1") | (DTAJmergetrioPASS$GTcons2_HG002=="0/0" & DTAJmergetrioPASS$GTcons2_HG003=="1/1" & DTAJmergetrioPASS$GTcons2_HG004=="0/1") | (DTAJmergetrioPASS$GTcons2_HG002=="0/0" & DTAJmergetrioPASS$GTcons2_HG003=="0/1" & DTAJmergetrioPASS$GTcons2_HG004=="1/1") | (DTAJmergetrioPASS$GTcons2_HG002=="1/1" & DTAJmergetrioPASS$GTcons2_HG003=="0/0" & DTAJmergetrioPASS$GTcons2_HG004=="0/1") | (DTAJmergetrioPASS$GTcons2_HG002=="1/1" & DTAJmergetrioPASS$GTcons2_HG003=="0/1" & DTAJmergetrioPASS$GTcons2_HG004=="0/0"))
sum(DTAJmergetrioPASS$MendelianErrorPASS)
sum(DTAJmergetrioPASS$GTcons2_HG002!="./." & DTAJmergetrioPASS$GTcons2_HG003!="./." & DTAJmergetrioPASS$GTcons2_HG004!="./." & DTAJmergetrioPASS$GTcons2_HG002!="./1" & DTAJmergetrioPASS$GTcons2_HG003!="./1" & DTAJmergetrioPASS$GTcons2_HG004!="./1")
contingencytable <- xtabs(~DTAJmergetrioPASS$GTcons2_HG002+DTAJmergetrioPASS$GTcons2_HG003+DTAJmergetrioPASS$GTcons2_HG004, data=DTAJmergetrioPASS)
ftable(contingencytable,row.vars=c(1))
contingencytable <- xtabs(~DTAJmergetrioPASS$SVTYPE+DTAJmergetrioPASS$sizecat+DTAJmergetrioPASS$GTcons2_HG002+DTAJmergetrioPASS$GTcons2_HG003+DTAJmergetrioPASS$GTcons2_HG004, data=DTAJmergetrioPASS)
ftable(contingencytable,row.vars=c(1,2,3))

ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/2) + facet_grid( DistPASSMinlt1000 + GT_weighted__HG002_PB_70x_HQ2 ~ MultiTech + TR)
ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/2) + facet_grid(  MultiTech +GT_weighted__HG002_PB_70x_HQ2 ~ TR)
ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(alpha = 1/10) 
ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG3INS),], aes(x=log10(BNG_LEN_HG3INS),y=log10(SVLEN))) +  geom_point(alpha = 1/10) 
ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG4INS),], aes(x=log10(BNG_LEN_HG4INS),y=log10(SVLEN))) +  geom_point(alpha = 1/10) 
ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG4INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(BNG_LEN_HG3INS))) +  geom_point(alpha = 1/10) 
sum(DTAJmergetrioPASS$DistPASSMinlt1000)
sum(DTAJmergetrioPASS$DistPASSMinlt1000 & abs(DTAJmergetrioPASS$SVLEN)>49)
sum( abs(DTAJmergetrioPASS$SVLEN)>49)

#DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2
View(DTAJmergetrioPASS[DTAJmergetrioPASS$DistPASSMinlt1000 ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_10X_86x_HQ2_HP1,GT_weighted__HG002_10X_86x_HQ2_HP2,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$CompoundHet_PB_HG002 ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$CompoundHet_10X_HG002 ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>4999 ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG2INS) & DTAJmergetrioPASS$SVLEN>500,.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$BNG_LEN_HG2INS),.(CHROM,POS,SVLEN,DistPASSMinlt1000,HG3count,HG4count,NumClusterSVs,GTcons,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,BNG_START_HG2INS,BNG_END_HG2INS,GT1.pacbio,GQ1.pacbio,GT1.IllMP.HQ,GT1.10X.HQ,GT1.Ill250bp.HQ,GTsupp,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$BNG_LEN_HG2INS>5500 & DTAJmergetrioPASS$BNG_LEN_HG2INS<6500,.(CHROM,POS,SVLEN,NumClusterSVs,GTcons,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,BNG_START_HG2INS,BNG_END_HG2INS,BNG_START_HG2INS-BNG_END_HG2INS,GT1.pacbio,GQ1.pacbio,GT1.IllMP.HQ,GT1.10X.HQ,GT1.Ill250bp.HQ,GTsupp,TR,ClusterIDs)])

View(DTAJmergetrioPASS[DTAJmergetrioPASS$ID=="HG4_Ill_Krunchall_6" ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,GTcons_HG002,GTcons2_HG002,GTsupp_HG002,GTsupp2_HG002,ClusterIDs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_10X_86x_HQ2_HP1,GT_weighted__HG002_10X_86x_HQ2_HP2,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2)])

#sites with variant on opposing haplotypes in 10X and PB
View(DTAJmergetrioPASS[DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1=="0/0" & DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2=="1/1" & DTAJmergetrioPASS$GT_weighted__HG002_10X_86x_HQ2_HP1=="1/1"  & DTAJmergetrioPASS$GT_weighted__HG002_10X_86x_HQ2_HP2=="0/0" ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
write.csv(DTAJmergetrioPASS[DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1=="0/0" & DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2=="1/1" & DTAJmergetrioPASS$GT_weighted__HG002_10X_86x_HQ2_HP1=="1/1"  & DTAJmergetrioPASS$GT_weighted__HG002_10X_86x_HQ2_HP2=="0/0" ,.(CHROM,POS,SVLEN,ID)],"/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/PBHPdiff10X.csv")


View(DTAJmergetrioPASS[DTAJmergetrioPASS$GTcons2_HG002=="0/1" & DTAJmergetrioPASS$GTcons_HG002=="./."  ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
sum(DTAJmergetrioPASS$GTcons2_HG002=="0/1" & DTAJmergetrioPASS$GTcons_HG002=="1/1" )
sum(DTAJmergetrioPASS$GTcons2_HG002=="0/1" & DTAJmergetrioPASS$GTcons_HG002=="./." )
View(DTAJmergetrioPASS[DTAJmergetrioPASS$GTcons2_HG002=="0/1" & DTAJmergetrioPASS$HG2count==0 ,.(CHROM,POS,SVLEN,DistPASSMinlt1000,HG3count,HG4count,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])

View(DTAJmergetrioPASS[sample(nrow(DTAJmergetrioPASS),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN<0,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>0,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>0,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>0,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>100,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>100,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>1000,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN>1000,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN< -100,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN< -100,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])
View(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN< -1000,][sample(nrow(DTAJmergetrioPASS[DTAJmergetrioPASS$SVLEN< -1000,]),10),.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,BNG_LEN_HG3DEL,BNG_LEN_HG3INS,BNG_LEN_HG4DEL,BNG_LEN_HG4INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])

View(DTAJmerge[DTAJmerge$CHROM=="1" & DTAJmerge$POS>106970906 & DTAJmerge$POS<106976906,.(CHROM,POS,SVLEN,NumClusterSVs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,BNG_LEN_HG3DEL,BNG_LEN_HG3INS,BNG_LEN_HG4DEL,BNG_LEN_HG4INS,GTcons_HG002,GTcons2_HG002,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs)])

sum(abs(DTAJmergetrioPASS$BNG_LEN_HG2INS-DTAJmergetrioPASS$SVLEN)<300,na.rm=TRUE)
sum(abs(DTAJmergetrioPASS$BNG_LEN_HG2INS-DTAJmergetrioPASS$SVLEN)<300 & DTAJmergetrioPASS$MultiTech==FALSE,na.rm=TRUE)
sum(abs(DTAJmergetrioPASS$BNG_LEN_HG2INS-DTAJmergetrioPASS$SVLEN)<300 & DTAJmergetrioPASS$MultiTech==FALSE & DTAJmergetrioPASS$GTsupp2_HG002==1,na.rm=TRUE)
sum(abs(DTAJmergetrioPASS$BNG_LEN_HG2INS-DTAJmergetrioPASS$SVLEN)<300 & DTAJmergetrioPASS$MultiTech==FALSE & DTAJmergetrioPASS$GTsupp2_HG002==1 & DTAJmergetrioPASS$GT_weighted__HG002_PB_70x_HQ2 != "./.",na.rm=TRUE)

ggplot(DTAJmergetrioPASS[!is.na(DTAJmergetrioPASS$alt_weighted_count.IllMP) & DTAJmergetrioPASS$GQ1.pacbio>40,], aes(x=log10(abs(SVLEN)),y=as.integer(as.character(alt_weighted_count.IllMP))/(as.integer(as.character(alt_weighted_count.IllMP))+as.integer(as.character(ref_weighted_count.IllMP))))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/2) + facet_grid( DistPASSMinlt1000 + GT1.pacbio ~ SVTYPE + TR)
ggplot(DTAJmergetrioPASS, aes(x=log10(abs(SVLEN)),y=as.integer(as.character(alt_weighted_count))/(as.integer(as.character(alt_weighted_count))+as.integer(as.character(ref_weighted_count))))) +  geom_point(aes(colour = factor(MultiTech)),alpha = 1/2) + facet_grid( DistPASSMinlt1000 + GT1.pacbio ~ SVTYPE + TR)

sum(DTAJmergetrioPASS$GQ1.pacbio<40)
hist(log10(-DTAJmergetrioPASS[DTAJmergetrioPASS$GQ1.pacbio<40,]$SVLEN))

test<- DTAJmergetrioPASS[DTAJmergetrioPASS$svm_score<0.2,]
sum(DTAJmergetrioPASS$svm_score<0.2, na.rm=TRUE)

sum(DTAJmergetrioPASS$GTcons=="0/1" & DTAJmergetrioPASS$DistPASSMinlt1000==FALSE , na.rm =TRUE  )
sum(DTAJmergetrioPASS$GTcons=="1/1" & DTAJmergetrioPASS$DistPASSMinlt1000==FALSE , na.rm =TRUE  )

ggplot(DTAJmergetrioPASS, aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( SVTYPE ~  TR)
ggplot(DTAJmergetrioPASS[abs(DTAJmergetrioPASS$SVLEN)>100,], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( SVTYPE ~  TR)
ggplot(DTAJmergetrioPASS[abs(DTAJmergetrioPASS$SVLEN)>1000,], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( SVTYPE ~  TR)

ggplot(DTAJmergetrioPASS[DTAJmergetrioPASS$SVTYPE != "COMPLEX",], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.05) + facet_grid( TR ~ SVTYPE, scales="free_y") + xlim(c(1,4))

ggplot(DTAJmerge[abs(DTAJmerge$SVLEN)>1000,], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(MultiTech))) + facet_grid( SVTYPE ~ MultiTech + TR)

write.csv(test,"/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/DTAJmergetrioPASS_DistPASSMinlt1000.csv")
#write.table(DTAJmergetrioPASS[DTAJmergetrioPASS$GTcons=="0/1" | DTAJmergetrioPASS$GTcons=="1/1",.(CHROM,POS,ID,REF,ALT,QUAL,FILTER,INFO,FORMAT,GTcons)],sep="\t",row.names=FALSE,col.names=FALSE,file="/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.2.2.2.clustered.simpleINFO.techcounts.genosvPASS.GT.vcf",quote=FALSE)

#only HG002 sites >49bp
DTAJmergetrioPASSHG2gt49 <- DTAJmergetrioPASS[abs(DTAJmergetrioPASS$SVLEN)>49 & !(DTAJmergetrioPASS$GTcons2_HG002=="0/0") & !(DTAJmergetrioPASS$GTcons2_HG002=="./."),][order(CHROM,POS)]
DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Back<-c(99999,DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$POS-DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$POS-nchar(DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1)]$REF))
DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Forward<-c(DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$POS-DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$POS-nchar(DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1)]$REF),99999)
DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Min<-pmin(DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Back,DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Forward)
DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Minlt1000<-(DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Min<1000)
DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_PB_HG002<-c(FALSE,DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$DistPASSBack<1000 & ((DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="0|1" & DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="1|0") | (DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="1|0" & DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="0|1") ))
DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_PB_HG002<-c(DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$CompoundHetHG2gt49_PB_HG002,FALSE) | DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_PB_HG002
DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_10X_HG002<-c(FALSE,DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$DistPASSBack<1000 & ((DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$GT_weighted__HG002_10X_86x_HQ2_phased=="0|1" & DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$GT_weighted__HG002_10X_86x_HQ2_phased=="1|0") | (DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$GT_weighted__HG002_10X_86x_HQ2_phased=="1|0" & DTAJmergetrioPASSHG2gt49[1:(nrow(DTAJmergetrioPASSHG2gt49)-1),]$GT_weighted__HG002_10X_86x_HQ2_phased=="0|1") ))
DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_10X_HG002<-c(DTAJmergetrioPASSHG2gt49[2:nrow(DTAJmergetrioPASSHG2gt49),]$CompoundHetHG2gt49_10X_HG002,FALSE) | DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_10X_HG002
sum(DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_PB_HG002 | DTAJmergetrioPASSHG2gt49$CompoundHetHG2gt49_10X_HG002)
sum(DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Minlt1000)
sum( abs(DTAJmergetrioPASSHG2gt49$SVLEN)>49)
View(DTAJmergetrioPASSHG2gt49[DTAJmergetrioPASSHG2gt49$DistPASSHG2gt49Minlt1000 ,.(CHROM,POS,SVLEN,NumClusterSVs,HG2count,GTcons_HG002,GTcons2_HG002,GTsupp_HG002,GTsupp2_HG002,TR,ClusterIDs,BNG_LEN_HG2DEL,BNG_LEN_HG2INS,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_10X_86x_HQ2_HP1,GT_weighted__HG002_10X_86x_HQ2_HP2,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_HP2,GT_weighted__HG002_Ill_250bp_45x_HQ2,GT_weighted__HG002_Ill_6kbMP_15x_HQ2,GT_weighted__HG002_10X_86x_HQ2,GT_weighted__HG002_PB_70x_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP1,GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_HP2)])

ggplot(DTAJmergetrioPASSHG2gt49[abs(DTAJmergetrioPASSHG2gt49$SVLEN)<500,], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(DistPASSHG2gt49Minlt1000))) + facet_grid( SVTYPE ~  TR)
ggplot(DTAJmergetrioPASSHG2gt49[abs(DTAJmergetrioPASSHG2gt49$SVLEN)<500,], aes(x=(abs(SVLEN)))) +  geom_histogram(binwidth=10,aes(colour = factor(DistPASSHG2gt49Minlt1000))) + facet_grid( ~ SVTYPE  )
ggplot(DTAJmergetrioPASSHG2gt49[abs(DTAJmergetrioPASSHG2gt49$SVLEN)<500,], aes(x=((SVLEN)))) +  geom_histogram(binwidth=50,aes(colour = factor(DistPASSHG2gt49Minlt1000))) 

ggplot(DTAJmergetrioPASSHG2gt49[abs(DTAJmergetrioPASSHG2gt49$SVLEN)>500 & abs(DTAJmergetrioPASSHG2gt49$SVLEN)<10000,], aes(x=(abs(SVLEN)))) +  geom_histogram(binwidth=200,aes(colour = factor(DistPASSHG2gt49Minlt1000))) + facet_grid( ~ SVTYPE  )

write.table(DTAJmergetrioPASSHG2gt49[,c("CHROM","POS","END","SVLEN","DistPASSHG2gt49Minlt1000")],sep="\t",row.names=FALSE,col.names=FALSE,file="/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/svanalyzer_union_171212_v0.6_HG2_gt49bp.bed",quote=FALSE)

#make HG2 Tier1 data frame for writing to vcf
DTAJmergetrioPASSHG2gt49$PASSHG2=TRUE
AJmergeHG2all <- data.frame(merge(DTAJmerge,DTAJmergetrioPASSHG2gt49[,.(ID,DistPASSMinlt1000,DistPASSHG2gt49Minlt1000,PASStrio,PASSHG2,GTcons2_HG002,GTcons2_HG003,GTcons2_HG004,MendelianErrorPASS)],all.x=TRUE,by="ID",suffixes = c(".orig",".mod"))[order(CHROM,POS)])
AJmergeHG2all[is.na(AJmergeHG2all$PASSHG2),"PASSHG2"]<-FALSE
AJmergeHG2all$FILTER<-"NoConsensusGT"
AJmergeHG2all[(!is.na(AJmergeHG2all$GT_weighted__HG002_PB_70x) & AJmergeHG2all$GT_weighted__HG002_PB_70x == "0/0"),"FILTER"]<-"LongReadHomRef"
AJmergeHG2all[AJmergeHG2all$PASSHG2,"FILTER"]<-"PASS"
AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$ClusterMaxEditDist>0.4,"FILTER"]<-"MaxEditDistgt04"
AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$DistPASSHG2gt49Minlt1000,"FILTER"]<-"ClusteredCalls"
AJmergeHG2all$PASSHG2FINAL<-"FILTERED"
AJmergeHG2all[AJmergeHG2all$FILTER=="PASS","PASSHG2FINAL"]<-"PASS"
AJmergeHG2all[AJmergeHG2all$SVLEN > -50 & AJmergeHG2all$SVLEN < 50 & (AJmergeHG2all$GTcons2_HG002.orig == "0/1" | AJmergeHG2all$GTcons2_HG002.orig == "1/1"),"FILTER"]<-"lt50bp"
AJmergeHG2all[AJmergeHG2all$SVLEN<0,"SVTYPE"]<-"DEL"
AJmergeHG2all[AJmergeHG2all$SVLEN>0,"SVTYPE"]<-"INS"
AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG002.mod),"GTcons2_HG002.mod"]<-AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG002.mod),"GTcons2_HG002.orig"]
AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG003.mod),"GTcons2_HG003.mod"]<-AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG003.mod),"GTcons2_HG003.orig"]
AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG004.mod),"GTcons2_HG004.mod"]<-AJmergeHG2all[is.na(AJmergeHG2all$GTcons2_HG004.mod),"GTcons2_HG004.orig"]

sum(AJmergeHG2all$SVLEN> 0)
sum(AJmergeHG2all$SVLEN< 0)
sum(AJmergeHG2all$PASSHG2)
sum(AJmergeHG2all$PASSHG2 & AJmergeHG2all$SVLEN> 0)
sum(AJmergeHG2all$PASSHG2 & AJmergeHG2all$SVLEN< 0)
sum(AJmergeHG2all$PASSHG2 & !AJmergeHG2all$DistPASSHG2gt49Minlt1000 & AJmergeHG2all$SVLEN> 0)
sum(AJmergeHG2all$PASSHG2 & !AJmergeHG2all$DistPASSHG2gt49Minlt1000 & AJmergeHG2all$SVLEN< 0)
sum(AJmergeHG2all$FILTER=="PASS")
#AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG002=="./.",]$GTcons2_HG002<-AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG002=="./.",]$GT_weighted__HG002_PB_70x_HQ2
#AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG003=="./.",]$GTcons2_HG003<-AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG003=="./.",]$GT_weighted__HG003_PB_30x_HQ2
#AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG004=="./.",]$GTcons2_HG004<-AJmergeHG2all[AJmergeHG2all$PASSHG2 & AJmergeHG2all$GTcons2_HG004=="./.",]$GT_weighted__HG004_PB_30x_HQ2

AJmergeHG2all$FORMAT<-"GT:GTcons1:PB_GT:PB_REF:PB_ALT:PBHP_GT:PB_REF_HP1:PB_ALT_HP1:PB_REF_HP2:PB_ALT_HP2:TenX_GT:TenX_REF_HP1:TenX_ALT_HP1:TenX_REF_HP2:TenX_ALT_HP2:ILL250bp_GT:ILL250bp_REF:ILL250bp_ALT:ILLMP_GT:ILLMP_REF:ILLMP_ALT:BNG_LEN_DEL:BNG_LEN_INS:nabsys_svm"
AJmergeHG2all$FORMATHG2<-gsub("NA",".",paste(AJmergeHG2all$GTcons2_HG002.mod,AJmergeHG2all$GTcons_HG002,AJmergeHG2all$GT_weighted__HG002_PB_70x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_PB_70x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_PB_70x)),ifelse(AJmergeHG2all$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,AJmergeHG2all$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2)),ifelse(AJmergeHG2all$GT_weighted__HG002_10X_86x_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG002_10X_86x_HQ2,AJmergeHG2all$GT_weighted__HG002_10X_86x_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_10X_86x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_10X_86x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_10X_86x_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_10X_86x_HP2)),AJmergeHG2all$GT_weighted__HG002_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_Ill_250bp_45x)),AJmergeHG2all$GT_weighted__HG002_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG002_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG002_Ill_6kbMP_15x)),AJmergeHG2all$BNG_LEN_HG2DEL,AJmergeHG2all$BNG_LEN_HG2INS,AJmergeHG2all$svm_score,sep=":"))
AJmergeHG2all$FORMATHG3<-gsub("NA",".",paste(AJmergeHG2all$GTcons2_HG003.mod,AJmergeHG2all$GTcons_HG003,AJmergeHG2all$GT_weighted__HG003_PB_30x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_PB_30x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_PB_30x)),ifelse(AJmergeHG2all$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2,AJmergeHG2all$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2)),ifelse(AJmergeHG2all$GT_weighted__HG003_10X_36x_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG003_10X_36x_HQ2,AJmergeHG2all$GT_weighted__HG003_10X_36x_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_10X_36x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_10X_36x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_10X_36x_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_10X_36x_HP2)),AJmergeHG2all$GT_weighted__HG003_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_Ill_250bp_45x)),AJmergeHG2all$GT_weighted__HG003_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG003_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG003_Ill_6kbMP_15x)),AJmergeHG2all$BNG_LEN_HG3DEL,AJmergeHG2all$BNG_LEN_HG3INS,".",sep=":"))
AJmergeHG2all$FORMATHG4<-gsub("NA",".",paste(AJmergeHG2all$GTcons2_HG004.mod,AJmergeHG2all$GTcons_HG004,AJmergeHG2all$GT_weighted__HG004_PB_30x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_PB_30x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_PB_30x)),ifelse(AJmergeHG2all$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2,AJmergeHG2all$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2)),ifelse(AJmergeHG2all$GT_weighted__HG004_10X_47x_HQ2_phased=="",AJmergeHG2all$GT_weighted__HG004_10X_47x_HQ2,AJmergeHG2all$GT_weighted__HG004_10X_47x_HQ2_phased),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_10X_47x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_10X_47x_HP1)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_10X_47x_HP2)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_10X_47x_HP2)),AJmergeHG2all$GT_weighted__HG004_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_Ill_250bp_45x)),AJmergeHG2all$GT_weighted__HG004_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_ref_HG004_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergeHG2all$weighted_count_alt_HG004_Ill_6kbMP_15x)),AJmergeHG2all$BNG_LEN_HG4DEL,AJmergeHG2all$BNG_LEN_HG4INS,".",sep=":"))

AJmergeHG2all$INFO<-gsub("NA",".",paste0(AJmergeHG2all$INFO,"DistPASSHG2gt49Minlt1000=",AJmergeHG2all$DistPASSHG2gt49Minlt1000,";DistPASSMinlt1000=",AJmergeHG2all$DistPASSMinlt1000,";MendelianError=",AJmergeHG2all$MendelianErrorPASS,";HG003_GT=",AJmergeHG2all$GTcons2_HG003.mod,";HG004_GT=",AJmergeHG2all$GTcons2_HG004.mod,";TRall=",AJmergeHG2all$TRall,";TRgt100=",AJmergeHG2all$TRgt100,";TRgt10k=",AJmergeHG2all$TRgt10k,";segdup=",AJmergeHG2all$segdup))
head(AJmergeHG2all$INFO)
head(AJmergeHG2all$FORMATHG2)

AJmergeHG2all$sizecatorder<-AJmergeHG2all$sizecat
AJmergeHG2all[AJmergeHG2all$sizecat=="50to99",]$sizecatorder<-"050to99"
AJmergeHG2all$TRcat<-"noTRgt100bp"
AJmergeHG2all[AJmergeHG2all$TRgt100,]$TRcat<-"TRgt100bp"
AJmergeHG2all$size1k<-"Smaller than 1000bp"
AJmergeHG2all[AJmergeHG2all$sizecat=="gt1000",]$size1k<-"Larger than 1000bp"

#Size distributions
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=log10(abs(SVLEN)))) +  geom_histogram(binwidth=0.1,aes(colour = factor(TRcat))) + facet_grid( SVTYPE ~  TRcat)
#**paper
ggplot(AJmergeHG2all[abs(AJmergeHG2all$SVLEN)<1000 & AJmergeHG2all$FILTER=="PASS",], aes(x=abs(SVLEN))) +  geom_histogram(binwidth=20,aes(colour = factor(TRcat)))  + theme_grey(base_size = 22) + facet_grid( SVTYPE ~  TRcat)
ggplot(AJmergeHG2all[abs(AJmergeHG2all$SVLEN)>900 & abs(AJmergeHG2all$SVLEN)<10000 & AJmergeHG2all$FILTER=="PASS",], aes(x=abs(SVLEN))) +  geom_histogram(binwidth=200,aes(colour = factor(TRcat))) + theme_grey(base_size = 22) + facet_grid( SVTYPE ~  TRcat)

#BioNano size vs SVLEN
#ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(colour = factor(PASSHG2FINAL)),alpha = 1/6) + facet_grid( SVTYPE ~ TRcat)
ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2INS),], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(),alpha = 1/20) + facet_grid(  ~ PASSHG2FINAL)
ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL),], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(),alpha = 1/20) + facet_grid(  ~ PASSHG2FINAL)
#**paper
ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL) & AJmergeHG2all$FILTER=="PASS",], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(),alpha = 1/20) + theme_grey(base_size = 22) + facet_grid(  ~ SVTYPE)+xlim(c(2,5))+ylim(c(2,5))
ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL) & AJmergeHG2all$FILTER=="PASS",], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(),alpha = 1/8) + theme_minimal(base_size = 22) +xlab("Log10(Bionano Deletion Size)")+ylab("Log10(Benchmark Size)")  +xlim(c(2,5))+ylim(c(2,5))
ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2INS) & AJmergeHG2all$FILTER=="PASS",], aes(x=log10(BNG_LEN_HG2INS),y=log10(SVLEN))) +  geom_point(aes(),alpha = 1/8) + theme_minimal(base_size = 22) +xlab("Log10(Bionano Insertion Size)")+ylab("Log10(Benchmark Size)")  +xlim(c(2,5))+ylim(c(2,5))
#ggplot(AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL),], aes(x=log10(BNG_LEN_HG2DEL),y=log10(-SVLEN))) +  geom_point(aes(colour = factor(PASSHG2FINAL)),alpha = 1/2) + facet_grid( SVTYPE ~ TRcat)
quantile(abs(1-(-AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL) & AJmergeHG2all$SVLEN< -1000 & AJmergeHG2all$FILTER=="PASS","BNG_LEN_HG2DEL"]/AJmergeHG2all[!is.na(AJmergeHG2all$BNG_LEN_HG2DEL) & AJmergeHG2all$SVLEN< -1000 & AJmergeHG2all$FILTER=="PASS","SVLEN"])),probs = c(25,50,75,90,95,99)/100)

#Read support from each dataset
#**paper
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_ref_HG002_PB_70x)),y=as.integer(as.character(weighted_count_alt_HG002_PB_70x)))) +  geom_point(aes(colour = factor(GTcons2_HG002.mod)),alpha = 1/10)+scale_color_manual(values=cbbPalette) + theme_grey(base_size = 22)+theme(legend.position="bottom")+xlab("Number of reads supporting reference")+ylab("Number of reads supporting SV")  + facet_grid( SVTYPE ~ TRcat )+xlim(c(0,75))+ylim(c(0,150))
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_250bp_45x)),y=as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x)))) +  geom_point(aes(colour = factor(GTcons2_HG002.mod)),alpha = 1/30) + facet_grid( SVTYPE ~ TRcat )+xlim(c(0,80))+ylim(c(0,80))
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_ref_HG002_Ill_6kbMP_15x)),y=as.integer(as.character(weighted_count_alt_HG002_Ill_6kbMP_15x)))) +  geom_point(aes(colour = factor(GTcons2_HG002.mod)),alpha = 1/30) + facet_grid( SVTYPE ~ TRcat )+xlim(c(0,500))+ylim(c(0,1000))
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP1))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP1))), y=as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))/(as.integer(as.character(weighted_count_ref_HG002_10X_86x_HP2))+as.integer(as.character(weighted_count_alt_HG002_10X_86x_HP2))))) +  geom_point(position=position_jitter(width=.01,height=.01),aes(colour = factor(GTcons2_HG002.mod)),alpha = 1/10) +facet_grid(  SVTYPE ~ TRcat)+xlim(c(0,1))+ylim(c(0,1))

#**paper
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_alt_HG002_PB_70x))/(as.integer(as.character(weighted_count_ref_HG002_PB_70x))+as.integer(as.character(weighted_count_alt_HG002_PB_70x))))) +  geom_histogram(binwidth=0.05,aes(fill = factor(GTcons2_HG002.mod))) +scale_fill_manual(values=cbbPalette) + xlab("Fraction of reads supporting SV") + theme_grey(base_size = 22) +theme(legend.position="bottom")+ facet_grid( SVTYPE ~ TRcat )
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x))/(as.integer(as.character(weighted_count_ref_HG002_Ill_250bp_45x))+as.integer(as.character(weighted_count_alt_HG002_Ill_250bp_45x))))) +  geom_histogram(binwidth=0.05,aes(fill = factor(GTcons2_HG002.mod))) +scale_fill_manual(values=cbbPalette) + xlab("Fraction of reads supporting SV") + theme_grey(base_size = 22) +theme(legend.position="bottom")+ facet_grid( SVTYPE ~ TRcat )

#Fraction of calls discovered by short and long reads
AJmergeHG2allDT<-data.table(AJmergeHG2all)
discshortgt0<-AJmergeHG2allDT[FILTER=="PASS",sum(Illcalls+CGcalls+TenXcalls>0)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
discshortgt0$cat<-"ShortReadDiscovery"
discshortgt1<-AJmergeHG2allDT[FILTER=="PASS",sum(Illcalls+CGcalls+TenXcalls>1)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
disclonggt0<-AJmergeHG2allDT[FILTER=="PASS",sum(PBcalls>0)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
disclonggt0$cat<-"LongReadDiscovery"
disclonggt1<-AJmergeHG2allDT[FILTER=="PASS",sum(PBcalls>1)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
discbionano<-AJmergeHG2allDT[FILTER=="PASS",sum(abs(BNG_LEN_HG2INS-SVLEN)<300 | abs(BNG_LEN_HG2DEL+SVLEN)<300,na.rm = TRUE)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
discbionano$cat<-"discbionano"

#Fraction of calls supported by Illumina
suppIllgt5<-AJmergeHG2allDT[FILTER=="PASS",sum(as.numeric(weighted_count_alt_HG002_Ill_250bp_45x)>5)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
suppIllgt5$cat<-"suppIllgt5"
#suppIllGT<-AJmergeHG2allDT[FILTER=="PASS",sum(GT_weighted__HG002_Ill_250bp_45x_HQ2 == "0/1" | GT_weighted__HG002_Ill_250bp_45x_HQ2 == "1/1" | GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == "0/1" | GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == "1/1")/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
suppIllGT<-AJmergeHG2allDT[FILTER=="PASS",sum(GT_weighted__HG002_Ill_250bp_45x_HQ2 == GTcons2_HG002.mod | GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == GTcons2_HG002.mod)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]
suppIllGT$cat<-"ShortReadGenotyped"
suppnabsys<-AJmergeHG2allDT[FILTER=="PASS",sum(!is.na(svm_score) & svm_score>0.9)/sum(Illcalls>-1),by=.(sizecatorder,TRcat,SVTYPE)]


#merge discovered/supported data
discsuppmerged<-merge(disclonggt0,merge(suppIllgt5,discshortgt0,by=c("sizecatorder","TRcat","SVTYPE"),suffixes = c(".suppIllgt5",".discshortgt0")),by=c("sizecatorder","TRcat","SVTYPE"),suffixes = c(".disclonggt0",""))
#discsuppfig<-rbind(discshortgt0,disclonggt0,suppIllgt5,suppIllGT,discbionano)
discsuppfig<-rbind(discshortgt0,disclonggt0,suppIllGT)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
#**paper
#ggplot(discsuppfig, aes(x=sizecatorder, y=1-V1)) +  geom_point(stat="identity", aes(color=cat), size=5) +scale_colour_manual(values=cbbPalette) +xlab("Size Range")+ylab("False Negative Rate") +scale_y_continuous(trans='log10') + theme_grey(base_size = 22) + theme(legend.position="bottom") +facet_grid( SVTYPE  ~ TRcat)
ggplot(discsuppfig, aes(x=sizecatorder, y=V1)) +  geom_bar(stat="identity", aes(fill=cat), size=1, position=position_dodge()) +scale_fill_manual(values=cbbPalette) +xlab("Size Range")+ylab("Recall")  + theme_grey(base_size = 12) + theme(legend.position="bottom") +facet_grid( SVTYPE  ~ TRcat)

#Fraction of calls not discovered from Illumina that are supported by Illumina
AJmergeHG2allDT[FILTER=="PASS",sum(Illcalls==0 & as.numeric(weighted_count_alt_HG002_Ill_250bp_45x)>5)/sum(Illcalls==0),by=.(sizecatorder,TRcat,SVTYPE)]

#Edit distance and exactly matching SVs
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=ClusterMaxEditDist)) +  geom_histogram(binwidth=0.01,aes(colour = factor(TRcat))) + facet_grid( SVTYPE ~  TRcat)
#**paper
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumExactMatchSVs, ..density..)) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) +xlab("Number of discovered SVs that match exactly")+ylab("Fraction of SVs")  + facet_grid( sizecatorder ~ SVTYPE + TRcat)

#Support for each call by # of discovery callsets and # of supporting technologies
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) + facet_grid( SVTYPE ~  TRcat)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) + facet_grid( sizecatorder + SVTYPE ~  TRcat)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) + facet_grid( sizecatorder ~ SVTYPE + TRcat)

ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_line(aes(y = 1 - ..y..,colour = factor(sizecatorder)), stat='ecdf')  + facet_grid(  SVTYPE  ~ TRcat)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_line(aes(y = 1 - ..y..,colour = factor(size1k)), stat='ecdf')  + facet_grid(  SVTYPE  ~ TRcat)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_line(aes(y = 1 - ..y..,colour = factor(SVTYPE),linetype = factor(TRcat)), stat='ecdf')  + facet_grid(    ~ sizecatorder )
#**paper
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=NumClusterSVs)) +  geom_line(aes(y = 1 - ..y..,colour = factor(SVTYPE),linetype = factor(TRcat)),size=1.5, stat='ecdf') +xlab("Number of Discovery Methods")+ylab("Inverse Cumulative Distribution") +scale_color_manual(values=cbbPalette) + theme_minimal(base_size = 22) + theme(legend.position="right") + facet_grid(  size1k  ~ .  )

# Number of supporting techs
AJmergeHG2all[is.na(AJmergeHG2all$BNG_LEN_HG2INS),]$BNG_LEN_HG2INS<- -100000
AJmergeHG2all[is.na(AJmergeHG2all$BNG_LEN_HG2DEL),]$BNG_LEN_HG2DEL<- -100000
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=(abs(BNG_LEN_HG2INS-SVLEN)<300 | abs(BNG_LEN_HG2DEL+SVLEN)<300) + (GT_weighted__HG002_Ill_250bp_45x_HQ2 == GTcons2_HG002.mod | GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == GTcons2_HG002.mod)+(GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == GTcons2_HG002.mod | GT_weighted__HG002_PB_70x_HQ2 == GTcons2_HG002.mod)+(GT_weighted__HG002_10X_86x_HQ2 == GTcons2_HG002.mod))) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) + facet_grid( sizecatorder ~ SVTYPE + TRcat)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=(abs(BNG_LEN_HG2INS-SVLEN)<300 | abs(BNG_LEN_HG2DEL+SVLEN)<300) + (Illcalls>0 | CGcalls>0 | GT_weighted__HG002_Ill_250bp_45x_HQ2 == GTcons2_HG002.mod | GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == GTcons2_HG002.mod)+(PBcalls>0 | GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == GTcons2_HG002.mod | GT_weighted__HG002_PB_70x_HQ2 == GTcons2_HG002.mod)+(TenXcalls>0 | GT_weighted__HG002_10X_86x_HQ2 == GTcons2_HG002.mod))) +  geom_histogram(binwidth=1,aes(colour = factor(TRcat))) + facet_grid( sizecatorder ~ SVTYPE + TRcat)
AJmergeHG2all$techsupport<- (abs(AJmergeHG2all$BNG_LEN_HG2INS-AJmergeHG2all$SVLEN)<300 | abs(AJmergeHG2all$BNG_LEN_HG2DEL+AJmergeHG2all$SVLEN)<300) + (AJmergeHG2all$Illcalls>0 | AJmergeHG2all$CGcalls>0 | AJmergeHG2all$GT_weighted__HG002_Ill_250bp_45x_HQ2 == AJmergeHG2all$GTcons2_HG002.mod | AJmergeHG2all$GT_weighted__HG002_Ill_6kbMP_15x_HQ2 == AJmergeHG2all$GTcons2_HG002.mod)+(AJmergeHG2all$PBcalls>0 | AJmergeHG2all$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2 == AJmergeHG2all$GTcons2_HG002.mod | AJmergeHG2all$GT_weighted__HG002_PB_70x_HQ2 == AJmergeHG2all$GTcons2_HG002.mod)+(AJmergeHG2all$TenXcalls>0 | AJmergeHG2all$GT_weighted__HG002_10X_86x_HQ2 == AJmergeHG2all$GTcons2_HG002.mod)
ggplot(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",], aes(x=paste(SVTYPE, size1k, sep="_") )) +  stat_bin(aes(group=factor(techsupport), y=..density..)) + geom_bar(aes(fill = factor(techsupport)), position = position_stack(reverse = TRUE)) + coord_flip() + theme(legend.position = "top")  + facet_grid(  ~ TRcat)
# **paper
nrow(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$techsupport>1,])/nrow(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS",])


#Mendelian violations and Genotype matrix for trio subset to final HG2 PASS sites >=50bp
AJmergeHG2all$MendelianErrorPASSFinal<-FALSE
AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$MendelianErrorPASSFinal <-(((AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="1/1" | AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/1") & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="0/0" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="0/0") | ((AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="1/1" | AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/0") & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="0/0" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="1/1") | ((AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="1/1" | AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/0") & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="1/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="0/0") | ((AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/0" | AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/1") & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="1/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="1/1") | (AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/0" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="1/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="0/1") | (AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="0/0" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="0/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="1/1") | (AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="1/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="0/0" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="0/1") | (AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod=="1/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod=="0/1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod=="0/0"))
sum(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$MendelianErrorPASSFinal)
sum(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod!="./1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod!="./1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod!="./1")
sum(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$MendelianErrorPASSFinal)/(sum(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$MendelianErrorPASSFinal)+sum(AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod!="./." & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod!="./1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod!="./1" & AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod!="./1"))
#**paper
contingencytable <- xtabs(~AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG002.mod+AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG003.mod+AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",]$GTcons2_HG004.mod, data=AJmergeHG2all[AJmergeHG2all$FILTER=="PASS" & AJmergeHG2all$CHROM!="X" & AJmergeHG2all$CHROM!="Y",])
ftable(contingencytable,row.vars=c(1))
contingencytable <- xtabs(~DTAJmerge$SVTYPE+DTAJmerge$sizecat+DTAJmerge$GTcons_HG002+DTAJmerge$GTcons_HG003+DTAJmerge$GTcons_HG004, data=DTAJmerge)
ftable(contingencytable,row.vars=c(1,2,3))


write.table(AJmergeHG2all[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO","FORMAT","FORMATHG2")],sep="\t",row.names=FALSE,col.names=FALSE,file="/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/svanalyzer_union_171212_v0.6_Tier1PASS_HG2_nohead.vcf",quote=FALSE)
#  sed 's/^X/23/;s/^Y/24/;s/^MT/25/' svanalyzer_union_171212_v0.6_Tier1PASS_HG2_nohead.vcf | sort -k1,1n -k2,2n -k4,4 -k5,5 | sed 's/^23/X/;s/^24/Y/;s/^25/MT/' | cat header_v0.6.txt - | /Applications/bioinfo/htslib-1.3/bgzip -c > svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz
# /Applications/bioinfo/htslib-1.3/tabix -f svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz
# /Applications/bioinfo/bcftools/bcftools norm -D -c x -f /Users/jzook/Documents/references/human_g1k_v37.fasta svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz > svanalyzer_union_171212_Tier1_HG2_v0.6_norm.vcf

#below commands now in createsvbedv0.6.sh run from hs37d5 dir of SVanalyzer
# zgrep -v ^# svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz | awk '{FS=OFS="\t"} { if($7=="ClusteredCalls" || $7=="lt50bp") print $1, $2-50, $2+length($4)+50}' > svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered.bed
# zgrep -v ^# svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz | awk '{FS=OFS="\t"} { if($7=="NoConsensusGT") print $1, $2-50, $2+length($4)+50}' > svanalyzer_union_171212_v0.6_Tier1PASS_HG2_noConsGT.bed
# /Applications/bioinfo/bedtools2.26.0/bin/intersectBed -wa -a /Users/jzook/Downloads/repeats_trfSimplerepLowcomplex_merged50_slop5.bed -b svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered.bed | /Applications/bioinfo/bedtools2.26.0/bin/multiIntersectBed -i stdin svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered.bed | /Applications/bioinfo/bedtools2.26.0/bin/mergeBed -i stdin -d 50 | awk '{FS=OFS="\t"} { print $1, $2-50, $3+50}' | awk '{FS=OFS="\t"} { if($2<0) $2=0; print}' > svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered_repeatexpanded.bed
# /Applications/bioinfo/bedtools2.26.0/bin/intersectBed -wa -a /Users/jzook/Downloads/repeats_trfSimplerepLowcomplex_merged50_slop5.bed -b svanalyzer_union_171212_v0.6_Tier1PASS_HG2_noConsGT.bed | /Applications/bioinfo/bedtools2.26.0/bin/multiIntersectBed -i stdin svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered.bed | /Applications/bioinfo/bedtools2.26.0/bin/mergeBed -i stdin -d 50 | awk '{FS=OFS="\t"} { print $1, $2-50, $3+50}' | awk '{FS=OFS="\t"} { if($2<0) $2=0; print}' > svanalyzer_union_171212_v0.6_Tier1PASS_HG2_noConsGT_repeatexpanded.bed
# gunzip -c svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz | awk '($1 ~ /^#/) || $7=="PASS"' | /Applications/bioinfo/bedtools2.26.0/bin/intersectBed -v -a svanalyzer_union_171212_v0.6_Tier1PASS_HG2_noConsGT_repeatexpanded.bed -b stdin > svanalyzer_union_171212_v0.6_Tier1PASS_HG2_noConsGT_repeatexpanded_noPASSoverlap.bed
# gunzip -c svanalyzer_union_171212_Tier1_HG2_v0.6.vcf.gz | awk '($1 ~ /^#/) || $7=="PASS"' | /Applications/bioinfo/bedtools2.26.0/bin/intersectBed -wa -a stdin -b svanalyzer_union_171212_v0.6_Tier1PASS_HG2_lt50orClustered_repeatexpanded.bed | wc -l



#make data frame for writing to vcf
AJmergetrioall <- data.frame(merge(DTAJmerge,DTAJmergetrioPASS[,.(ID,DistPASSMinlt1000,PASStrio,GTcons2_HG002,GTcons2_HG003,GTcons2_HG004)],all.x=TRUE,by="ID",suffixes = c(".orig",".mod"))[order(CHROM,POS)])
AJmergetrioall[is.na(AJmergetrioall$PASStrio),"PASStrio"]<-FALSE
AJmergetrioall$FILTER<-"NoConsensusGT"
AJmergetrioall[(!is.na(AJmergetrioall$GT_weighted__HG002_PB_70x) & AJmergetrioall$GT_weighted__HG002_PB_70x == "0/0" & !is.na(AJmergetrioall$GT_weighted__HG003_PB_30x) & AJmergetrioall$GT_weighted__HG003_PB_30x == "0/0" & !is.na(AJmergetrioall$GT_weighted__HG004_PB_30x) & AJmergetrioall$GT_weighted__HG004_PB_30x == "0/0"),"FILTER"]<-"LongReadHomRef"
AJmergetrioall[AJmergetrioall$PASStrio,"FILTER"]<-"PASS"

sum(AJmergetrioall$SVLEN> 0)
sum(AJmergetrioall$SVLEN< 0)
sum(AJmergetrioall$PASStrio)
sum(AJmergetrioall$PASStrio & AJmergetrioall$SVLEN> 0)
sum(AJmergetrioall$PASStrio & AJmergetrioall$SVLEN< 0)
#AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG002=="./.",]$GTcons2_HG002<-AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG002=="./.",]$GT_weighted__HG002_PB_70x_HQ2
#AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG003=="./.",]$GTcons2_HG003<-AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG003=="./.",]$GT_weighted__HG003_PB_30x_HQ2
#AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG004=="./.",]$GTcons2_HG004<-AJmergetrioall[AJmergetrioall$PASStrio & AJmergetrioall$GTcons2_HG004=="./.",]$GT_weighted__HG004_PB_30x_HQ2

AJmergetrioall$FORMAT<-"GT:GTcons1:PB_GT:PB_REF:PB_ALT:PBHP_GT:PB_REF_HP1:PB_ALT_HP1:PB_REF_HP2:PB_ALT_HP2:TenX_GT:TenX_REF_HP1:TenX_ALT_HP1:TenX_REF_HP2:TenX_ALT_HP2:ILL250bp_GT:ILL250bp_REF:ILL250bp_ALT:ILLMP_GT:ILLMP_REF:ILLMP_ALT:BNG_LEN_DEL:BNG_LEN_INS:nabsys_svm"
AJmergetrioall$FORMATHG2<-gsub("NA",".",paste(AJmergetrioall$GTcons2_HG002.mod,AJmergetrioall$GTcons_HG002,AJmergetrioall$GT_weighted__HG002_PB_70x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_PB_70x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_PB_70x)),ifelse(AJmergetrioall$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased=="",AJmergetrioall$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2,AJmergetrioall$GT_weighted__HG002_PB_70x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_PB_70x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_PB_70x_RG_HP10XPASS_HP2)),ifelse(AJmergetrioall$GT_weighted__HG002_10X_86x_HQ2_phased=="",AJmergetrioall$GT_weighted__HG002_10X_86x_HQ2,AJmergetrioall$GT_weighted__HG002_10X_86x_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_10X_86x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_10X_86x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_10X_86x_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_10X_86x_HP2)),AJmergetrioall$GT_weighted__HG002_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_Ill_250bp_45x)),AJmergetrioall$GT_weighted__HG002_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG002_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG002_Ill_6kbMP_15x)),AJmergetrioall$BNG_LEN_HG2DEL,AJmergetrioall$BNG_LEN_HG2INS,AJmergetrioall$svm_score,sep=":"))
AJmergetrioall$FORMATHG3<-gsub("NA",".",paste(AJmergetrioall$GTcons2_HG003.mod,AJmergetrioall$GTcons_HG003,AJmergetrioall$GT_weighted__HG003_PB_30x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_PB_30x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_PB_30x)),ifelse(AJmergetrioall$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_phased=="",AJmergetrioall$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2,AJmergetrioall$GT_weighted__HG003_PB_30x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_PB_30x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_PB_30x_RG_HP10XPASS_HP2)),ifelse(AJmergetrioall$GT_weighted__HG003_10X_36x_HQ2_phased=="",AJmergetrioall$GT_weighted__HG003_10X_36x_HQ2,AJmergetrioall$GT_weighted__HG003_10X_36x_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_10X_36x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_10X_36x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_10X_36x_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_10X_36x_HP2)),AJmergetrioall$GT_weighted__HG003_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_Ill_250bp_45x)),AJmergetrioall$GT_weighted__HG003_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG003_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG003_Ill_6kbMP_15x)),AJmergetrioall$BNG_LEN_HG3DEL,AJmergetrioall$BNG_LEN_HG3INS,".",sep=":"))
AJmergetrioall$FORMATHG4<-gsub("NA",".",paste(AJmergetrioall$GTcons2_HG004.mod,AJmergetrioall$GTcons_HG004,AJmergetrioall$GT_weighted__HG004_PB_30x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_PB_30x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_PB_30x)),ifelse(AJmergetrioall$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_phased=="",AJmergetrioall$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2,AJmergetrioall$GT_weighted__HG004_PB_30x_RG_HP10XPASS_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_PB_30x_RG_HP10XPASS_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_PB_30x_RG_HP10XPASS_HP2)),ifelse(AJmergetrioall$GT_weighted__HG004_10X_47x_HQ2_phased=="",AJmergetrioall$GT_weighted__HG004_10X_47x_HQ2,AJmergetrioall$GT_weighted__HG004_10X_47x_HQ2_phased),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_10X_47x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_10X_47x_HP1)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_10X_47x_HP2)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_10X_47x_HP2)),AJmergetrioall$GT_weighted__HG004_Ill_250bp_45x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_Ill_250bp_45x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_Ill_250bp_45x)),AJmergetrioall$GT_weighted__HG004_Ill_6kbMP_15x_HQ2,as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_ref_HG004_Ill_6kbMP_15x)),as.integer(0.5+as.numeric(AJmergetrioall$weighted_count_alt_HG004_Ill_6kbMP_15x)),AJmergetrioall$BNG_LEN_HG4DEL,AJmergetrioall$BNG_LEN_HG4INS,".",sep=":"))

AJmergetrioall$INFO<-gsub("NA",".",paste0(AJmergetrioall$INFO,";DistPASSMinlt1000=",AJmergetrioall$DistPASSMinlt1000,";MendelianError=",AJmergetrioall$MendelianError))
head(AJmergetrioall$FORMATHG2)

write.table(AJmergetrioall[,c("CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO","FORMAT","FORMATHG2","FORMATHG3","FORMATHG4")],sep="\t",row.names=FALSE,col.names=FALSE,file="/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/svanalyzer_union_171212_v0.5.0_nohead.vcf",quote=FALSE)

# cat header_v0.5.0.txt svanalyzer_union_171212_v0.5.0_nohead.vcf | /Applications/bioinfo/htslib-1.3/bgzip -c > svanalyzer_union_171212_v0.5.0.vcf.gz
# /Applications/bioinfo/htslib-1.3/tabix -f svanalyzer_union_171212_v0.5.0.vcf.gz
# /Applications/bioinfo/bcftools/bcftools norm -D -c x -f /Users/jzook/Documents/references/human_g1k_v37.fasta svanalyzer_union_171212_v0.5.0.vcf.gz > svanalyzer_union_171212_v0.5.0_norm.vcf


sum( DTAJmergetrioPASS$DistPASSMinlt1000==FALSE)
sum(DTAJmergetrioPASS$NumExactMatchSVs>3 & DTAJmergetrioPASS$DistPASSMinlt1000==FALSE)
sum(DTAJmergetrioPASS$SVLEN> 299 &  DTAJmergetrioPASS$DistPASSMinlt1000==FALSE)
sum(DTAJmergetrioPASS$SVLEN> 299 & DTAJmergetrioPASS$NumExactMatchSVs>1 & DTAJmergetrioPASS$DistPASSMinlt1000==FALSE)

#analyze distance from exact match
svdist<-fread("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.svdist", stringsAsFactors=FALSE, header = TRUE, sep = "\t")
colnames(svdist)<- c("ID1","ID2","MAXSHIFT","RELSHIFT","RELSIZEDIFF","RELDIST")
setkeyv(svdist, c("ID1","ID2"))
DTAJmergetrioPASSexactID <- DTAJmergetrioPASS[DTAJmergetrioPASS$NumExactMatchSVs>3 & DTAJmergetrioPASS$DistPASSMinlt1000==FALSE,.(ID,SVTYPE,SVLEN,sizecat,TR)]
setkey(DTAJmergetrioPASSexactID,"ID")
DTAJmergesvdist1 <- merge(DTAJmergetrioPASSexactID,svdist,by.x="ID",by.y="ID1",all.x=TRUE)
DTAJmergesvdist2 <- merge(DTAJmergetrioPASSexactID,svdist,by.x="ID",by.y="ID2",all.x=TRUE)
DTAJmergesvdist<-rbind(DTAJmergesvdist1,DTAJmergesvdist2, use.names=FALSE)

DTAJmergesvdist$indiv<-sapply(strsplit(as.character(sapply(strsplit(as.character(DTAJmergesvdist$ID2),'_'), "[", 1)),'_'), "[", 1)
DTAJmergesvdist$tech<-sub("Ill.*","Ill",sub("10X","TenX",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(DTAJmergesvdist$ID2)),'_'), "[", 2)),'_'), "[", 1)))
DTAJmergesvdist$caller<-sub(".*_(.*_.*)_.*","\\1",as.character(DTAJmergesvdist$ID2))
DTAJmergesvdist$techtype<-sub("PB.*","Long",sub("CG.*","Short",sub("Ill.*","Short",sub("10X","Short",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(DTAJmergesvdist$ID2)),'_'), "[", 2)),'_'), "[", 1)))))
ggplot(DTAJmergesvdist, aes(x=RELDIST, ..density..)) +  geom_histogram(binwidth=0.01,aes(colour = factor(tech))) + xlim(c(0,.4)) + facet_grid( SVTYPE + sizecat ~ tech + TR)
ggplot(DTAJmergesvdist, aes(x=RELDIST, ..density..)) +  geom_histogram(binwidth=0.01,aes(colour = factor(tech))) + xlim(c(0,.4)) + facet_grid( SVTYPE + sizecat ~ techtype + TR)


callers<-unique(DTAJmergesvdist$caller)
sizecats<-c("20to49","50to99","100to299","300to999","gt1000")
SVTYPEs<-c("DEL","INS","COMPLEX")
pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELDIST.histograms.pdf")
for (i in sizecats) {
  for (j in SVTYPEs) {
    df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE==j & DTAJmergesvdist$sizecat==i,]
    print(ggplot(df.segment, aes(x=RELDIST, ..density..)) +  geom_histogram(binwidth=0.01,aes(colour = factor(tech))) + coord_cartesian(xlim = c(0,0.4))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i,j))) + facet_grid( caller ~  TR))
  }
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELDISTxSVLEN.histograms.pdf")
for (i in sizecats) {
  for (j in SVTYPEs) {
    df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE==j & DTAJmergesvdist$sizecat==i,]
    print(ggplot(df.segment, aes(x=RELDIST*abs(SVLEN), ..density..)) +  geom_histogram(binwidth=1,aes(colour = factor(tech))) + coord_cartesian(xlim = c(0,100))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i,j))) + facet_grid( caller ~  TR))
  }
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELDISTxSVLEN.histograms.bycaller.pdf")
for (i in callers) {
    df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$caller==i,]
    print(ggplot(df.segment, aes(x=RELDIST*abs(SVLEN), ..density..)) +  geom_histogram(binwidth=1) + coord_cartesian(xlim = c(0,100))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i))) + facet_grid( SVTYPE+sizecat ~  TR))
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELDIST.histograms.bycaller.pdf")
for (i in callers) {
  df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$caller==i,]
  print(ggplot(df.segment, aes(x=RELDIST, ..density..)) +  geom_histogram(binwidth=.01) + coord_cartesian(xlim = c(0,0.4))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i))) + facet_grid( SVTYPE+sizecat ~  TR))
}
dev.off()

#relative size difference
pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELSIZEDIFF.histograms.pdf")
for (i in sizecats) {
  for (j in SVTYPEs) {
    df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE==j & DTAJmergesvdist$sizecat==i,]
    print(ggplot(df.segment, aes(x=RELSIZEDIFF, ..density..)) +  geom_histogram(binwidth=0.01,aes(colour = factor(tech))) + coord_cartesian(xlim = c(0,0.4))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i,j))) + facet_grid( caller ~  TR))
  }
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELSIZEDIFFxSVLEN.histograms.pdf")
for (i in sizecats) {
  for (j in SVTYPEs) {
    df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE==j & DTAJmergesvdist$sizecat==i,]
    print(ggplot(df.segment, aes(x=RELSIZEDIFF*abs(SVLEN), ..density..)) +  geom_histogram(binwidth=1,aes(colour = factor(tech))) + coord_cartesian(xlim = c(0,100))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i,j))) + facet_grid( caller ~  TR))
  }
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELSIZEDIFFxSVLEN.histograms.bycaller.pdf")
for (i in callers) {
  df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$caller==i,]
  print(ggplot(df.segment, aes(x=RELSIZEDIFF*abs(SVLEN), ..density..)) +  geom_histogram(binwidth=1) + coord_cartesian(xlim = c(0,100))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i))) + facet_grid( SVTYPE+sizecat ~  TR))
}
dev.off()

pdf("/Users/jzook/Documents/OneDrive - National Institute of Standards and Technology (NIST)/AJTrio/SVs/triounion_171212/union_170509_refalt.completenewdist.RELSIZEDIFF.histograms.bycaller.pdf")
for (i in callers) {
  df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$caller==i,]
  print(ggplot(df.segment, aes(x=RELSIZEDIFF, ..density..)) +  geom_histogram(binwidth=.01) + coord_cartesian(xlim = c(0,0.4))  +theme(strip.text.y = element_text(size = 6, colour = "black", angle = 0))+labs(title=(paste(i))) + facet_grid( SVTYPE+sizecat ~  TR))
}
dev.off()
sum(DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE=="INS"  & DTAJmergesvdist$sizecat=="100to299" & (DTAJmergesvdist$caller=="PB_pbsv"),na.rm=TRUE)
df.segment <- DTAJmergesvdist[DTAJmergesvdist$indiv=="HG2" & DTAJmergesvdist$SVTYPE=="INS" & DTAJmergesvdist$sizecat=="100to299" & (DTAJmergesvdist$caller=="PB_pbsv" | DTAJmergesvdist$caller=="Ill_GATKHCSBGrefine" | DTAJmergesvdist$caller=="PB_SVrefinePBcR"),]
ggplot(df.segment, aes(x=RELDIST, ..density..)) +  geom_histogram(binwidth=.01,aes(colour = factor(tech))) + coord_cartesian(xlim = c(0,1.2)) + scale_x_continuous(breaks = seq(0, 1, 0.5), minor_breaks = seq(0, 1, 0.1)) +theme(axis.text=element_text(size=10),strip.text.x = element_text(size = 7, colour = "black", angle = 0))+labs(title=(paste(i,j))) + facet_grid( ~ caller  )

DTAJmergesvdistagg <- DTAJmergesvdist[, list(prop0=sum(RELDIST==0)/sum(RELDIST> -1),medianval=quantile(RELDIST, .50, na.rm=TRUE),upper90=quantile(RELDIST, .90, na.rm=TRUE),upper90dist=quantile(RELDIST*abs(SVLEN), .90, na.rm=TRUE)), by=list(caller,SVTYPE,sizecat)]
callerRELDIST0prop <- dcast(DTAJmergesvdistagg[DTAJmergesvdistagg$SVTYPE != "COMPLEX",], caller ~ SVTYPE + sizecat,value.var = 'prop0')
setorder(callerRELDIST0prop,caller)
callerRELDISTupper90 <- dcast(DTAJmergesvdistagg[DTAJmergesvdistagg$SVTYPE != "COMPLEX",], caller ~ SVTYPE + sizecat,value.var = 'upper90')
setorder(callerRELDISTupper90,caller)
callerRELDISTmedian <- dcast(DTAJmergesvdistagg[DTAJmergesvdistagg$SVTYPE != "COMPLEX",], caller ~ SVTYPE + sizecat,value.var = 'medianval')
setorder(callerRELDISTmedian,caller)
callerDISTupper90 <- dcast(DTAJmergesvdistagg[DTAJmergesvdistagg$SVTYPE != "COMPLEX",], caller ~ SVTYPE + sizecat,value.var = 'upper90dist')
setorder(callerDISTupper90,caller)

callerRELDIST0prop$tech <- sub("Ill.*","Ill",sub("10X","TenX",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDIST0prop$caller)),'_'), "[", 1)),'_'), "[", 1)))
callerRELDIST0prop$techtype <- sub("PB.*","Long",sub("CG.*","Short",sub("Ill.*","Short",sub("10X","Short",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDIST0prop$caller)),'_'), "[", 1)),'_'), "[", 1)))))
callerRELDIST0propmelt <- melt(callerRELDIST0prop,id=c("caller","techtype","tech"))
callerRELDIST0propmelt$sizecat = factor(callerRELDIST0propmelt$variable, levels=c('DEL_gt1000','DEL_300to999','DEL_100to299','DEL_50to99','DEL_20to49','INS_20to49','INS_50to99','INS_100to299','INS_300to999','INS_gt1000'))
ggplot(callerRELDIST0propmelt, aes(x = factor(sizecat), y = value, fill = tech))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDIST0propmelt, aes(x = factor(sizecat), y = value, fill = techtype))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDIST0propmelt[!is.na(callerRELDIST0propmelt$techtype)], aes(value, fill = techtype))+  geom_density(adjust=0.5)+geom_rug()+facet_grid(techtype~sizecat)+theme(axis.text.x= element_text(angle=90))+xlab("Proportion of Exact Matches by callset")


callerRELDISTupper90$tech <- sub("Ill.*","Ill",sub("10X","TenX",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDISTupper90$caller)),'_'), "[", 1)),'_'), "[", 1)))
callerRELDISTupper90$techtype <- sub("PB.*","Long",sub("CG.*","Short",sub("Ill.*","Short",sub("10X","Short",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDISTupper90$caller)),'_'), "[", 1)),'_'), "[", 1)))))
callerRELDISTupper90melt <- melt(callerRELDISTupper90,id=c("caller","techtype","tech"))
callerRELDISTupper90melt$sizecat = factor(callerRELDISTupper90melt$variable, levels=c('DEL_gt1000','DEL_300to999','DEL_100to299','DEL_50to99','DEL_20to49','INS_20to49','INS_50to99','INS_100to299','INS_300to999','INS_gt1000'))
ggplot(callerRELDISTupper90melt, aes(x = factor(sizecat), y = value, fill = tech))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDISTupper90melt, aes(x = factor(sizecat), y = value, fill = techtype))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDISTupper90melt[!is.na(callerRELDISTupper90melt$techtype)], aes(value, fill = techtype))+  geom_density(adjust=0.5)+geom_rug()+facet_grid(techtype~sizecat)+theme(axis.text.x= element_text(angle=90))+xlab("Proportion of Exact Matches by callset")


callerRELDISTmedian$tech <- sub("Ill.*","Ill",sub("10X","TenX",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDISTmedian$caller)),'_'), "[", 1)),'_'), "[", 1)))
callerRELDISTmedian$techtype <- sub("PB.*","Long",sub("CG.*","Short",sub("Ill.*","Short",sub("10X","Short",sapply(strsplit(as.character(sapply(strsplit(as.character(as.character(callerRELDISTmedian$caller)),'_'), "[", 1)),'_'), "[", 1)))))
callerRELDISTmedianmelt <- melt(callerRELDISTmedian,id=c("caller","techtype","tech"))
callerRELDISTmedianmelt$sizecat = factor(callerRELDISTmedianmelt$variable, levels=c('DEL_gt1000','DEL_300to999','DEL_100to299','DEL_50to99','DEL_20to49','INS_20to49','INS_50to99','INS_100to299','INS_300to999','INS_gt1000'))
ggplot(callerRELDISTmedianmelt, aes(x = factor(sizecat), y = value, fill = tech))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDISTmedianmelt, aes(x = factor(sizecat), y = value, fill = techtype))+  geom_dotplot(binaxis = 'y', binwidth=0.02, dotsize=1, stackdir = 'center',  position = position_dodge())
ggplot(callerRELDISTmedianmelt[!is.na(callerRELDISTmedianmelt$techtype)], aes(value, fill = techtype))+  geom_density(adjust=0.5)+geom_rug()+facet_grid(techtype~sizecat)+theme(axis.text.x= element_text(angle=90))+xlab("Proportion of Exact Matches by callset")

# ggplot(callerRELDIST0propmelt, aes(x = factor(variable), y = value, fill = tech)) +
#   geom_boxplot(alpha = 0.80) +
#   geom_point(aes(fill = tech), size = 5, shape = 21, position = position_jitterdodge()) +
#   theme(text = element_text(size = 18),
#         axis.title.x = element_blank(),
#         axis.title.y = element_blank(),
#         panel.grid.minor.x = element_blank(),
#         panel.grid.major.x = element_blank(),
#         legend.position = "none")

